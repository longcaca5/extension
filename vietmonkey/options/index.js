{const e=this,{window:t}=e,n="expose",l="injectInto",a="runAt",o="scripts",i=e=>"function"==typeof e,{Boolean:s,Error:r,Object:c,Promise:u,addEventListener:d,removeEventListener:p,chrome:m,performance:g}=e,{apply:h}=Reflect,v=h.call.bind({}.hasOwnProperty),f=c.call.bind(c.call),w="geckoProfiler"in m,b="#"+o,y=(m.runtime.getURL("/").slice(0,-1),m.runtime.getManifest()),x=(m.runtime.getURL(y.options_ui.page).split("#",1)[0],m.runtime.getURL(y.icons[16].replace("16.png","")),"settings"),C="about",_="recycleBin",k="frameId";(()=>{var h,S,U,z={8904:(r,h,S)=>{"use strict";S.d(h,{m:()=>ar}),S(1871);var U=S(5313),z=S(6711),D=S(2477),$=S(5010),R=S(6906),j=(S(3700),S(9994)),H=S(2262),E=S(9518);const I=(0,H.qj)({route:E.BC,canRenderScripts:[o,_,""].includes(E.BC.hash),scripts:[],removedScripts:[],importing:null,loading:!1,needRefresh:!1,storageSize:0,sync:[],title:null});var W=S(6252),T=S(2502);const O={class:"page-options"},M={key:0},A={class:"aside-content"},V=(0,W._)("img",{src:"/public/images/icon128.png"},null,-1),F=["textContent"],L=(0,W._)("hr",null,null,-1),P=["href","data-num-scripts","textContent"];var Y=S(7458),Z=S(9963);const B={class:"tab-installed",ref:"scroller"},N={key:0},q={class:"flex"},K={key:0,class:"flex flex-auto"},J={class:"btn-ghost",tabindex:"0"},G=["textContent"],X=["textContent"],Q=["textContent"],ee=["textContent"],te=["textContent"],ne=["value"],le=["textContent","value"],ae={class:"btn-ghost",tabindex:"0"},oe={class:"mr-2c"},ie=["placeholder"],se=["textContent"],re=["textContent"],ce=["textContent"],ue=["textContent"],de={key:0,class:"hint mx-1 my-1 flex flex-col"},pe=["textContent"],me=["textContent"],ge=["textContent"],he=["data-columns","data-show-order","data-table"];var ve=S(5168),fe=S(2380),we=S(392),be=S(9824),ye=S(7407),xe=S(6877),Ce=S(6653);const _e=".script",ke=50,Se=20,Ue=16,ze=500,De=R.T?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"dragstart",move:"mousemove",end:"mouseup"},$e=R.T&&c.assign(document.createElement("div"),{className:"dragging-noscroll"}),Re=["scroll","mouseenter","mouseleave"];let je,He,Ee,Ie,We,Te,Oe,Me,Ae,Ve,Fe,Le,Pe,Ye,Ze,Be,Ne,qe;function Ke(e,t,n){const l=n?d:p;Fe=e,Le=t,f(l,Fe,De.start,R.T?Qe:nt),R.T||(f(l,Fe,"dblclick",Je,!0),f(l,Fe,"mousedown",Ge,!0),n||Xe())}function Je(e){const t=getSelection(),n=e.target.closest(".script-name");n&&(t.removeAllRanges(),t.selectAllChildren(n))}function Ge(e){!e.altKey&&pt(e)&&(Ve.draggable=!0),f(d,Fe,"mouseup",Xe,!0)}function Xe(){Ve&&(Ve.draggable=!1),f(p,Fe,"mouseup",Xe,!0)}function Qe(e){pt(e)&&(Te=e,Oe=setTimeout(et,ze,"timer"),d(De.move,et),d(De.end,tt))}function et(e){tt(),"timer"===e&&(f(nt,Ve,Te),w&&it()&&(Fe.scrollTop+=1,Fe.scrollTop-=1))}function tt(){clearTimeout(Oe),p(De.move,et),p(De.end,tt)}function nt(e){var t;if(!pt(e))return;e.cancelable&&e.preventDefault();const{clientX:n,clientY:l}=(null==(t=e.touches)?void 0:t[0])||e,a=Ve.getBoundingClientRect(),o=Fe.getBoundingClientRect();je=Ve.cloneNode(!0),He=f([].filter,Fe.children,e=>"none"!==e.style.display),Ie=He.indexOf(Ve),We=Ie,He.splice(Ie,1),Ee=a.height,Me=n-a.left,Ae=l-a.top,Pe=o.top+ke,Ye=o.bottom-ke,qe={},Ve.classList.add("dragging-placeholder"),je.classList.add("dragging"),je.style.transform=`translate(${a.left}px, ${a.top}px)`,je.style.width=`${a.width}px`,Fe.appendChild(je),R.T&&Fe.insertAdjacentElement("afterBegin",$e),d(De.move,lt),d(De.end,at)}function lt(e){var t;const{clientX:n,clientY:l,target:a}=(null==(t=e.touches)?void 0:t[0])||e;let o;const i=R.T?dt(n,l):null==a.closest?void 0:a.closest(_e);if(i&&i!==Ve){const e=i.getBoundingClientRect(),t=l>e.top+e.height/2;o=Ve!==i[(t?"next":"previous")+"ElementSibling"],o&&(i.insertAdjacentElement(t?"afterEnd":"beforeBegin",Ve),ot(He.indexOf(i)+t))}je.style.transform=`translate(${n-Me}px, ${l-Ae}px)`,(st(l)||o)&&(qe={})}function at(){p(De.move,lt),p(De.end,at),ct(),je.remove(),R.T&&$e.remove(),Ve.classList.remove("dragging-placeholder"),Le(Ie,We)}function ot(e){const t=We<e?Ee:-Ee,n=He.slice(...We<e?[We,e]:[e,We]);n.forEach(e=>{e.style.transition="none",e.style.transform=`translateY(${t}px)`}),setTimeout(()=>n.forEach(({style:e})=>{e.removeProperty("transition"),e.removeProperty("transform")})),We=e}function it(){return Fe.scrollHeight>Fe.clientHeight}function st(e){const t=it()&&Math.min(1,Math.max(0,e-Ye,Pe-e)/ke);return!t&&Ze&&ct(),t&&!Ze&&(Ze=setInterval(rt,Ue),Re.forEach(e=>d(e,ut,!0))),Be=t&&(e>Ye?1:-1)*(1+t*Se|0),Ne=g.now(),!!t}function rt(){const e=g.now(),t=Be*(e-Ne)/Ue;Fe.scrollTop+=t,Ne=e}function ct(){Re.forEach(e=>p(e,ut,!0)),Ze&&clearInterval(Ze),Ze=0}function ut(e){e.stopPropagation()}function dt(e,t){var n;const l=`${e}:${t}`;return qe[l]||(qe[l]=null==(n=document.elementFromPoint(e,t))?void 0:n.closest(_e))}function pt(e){return Ve=e.target.closest(_e),Ve}const mt=["tabIndex"],gt={class:"script-icon hidden-xs"},ht=["href","data-hotkey"],vt=["src","data-no-icon"],ft={class:"script-name ellipsis"},wt=["textContent","data-order"],bt={class:"script-info flex ml-1c"},yt=["href","textContent","tabIndex"],xt=["textContent"],Ct=["textContent"],_t={class:"script-buttons script-buttons-left"},kt=["href","data-hotkey","tabIndex"],St=["data-hotkey","tabIndex"],Ut=["data-hotkey","tabIndex"],zt=(0,W._)("span",{class:"sep"},null,-1),Dt=["tabIndex"],$t=["href","tabIndex"],Rt=["textContent","title"],jt={class:"script-buttons script-buttons-right"},Ht=["data-hotkey","tabIndex"],Et=["data-hotkey","tabIndex"],It={props:["script","visible","viewTable","focused","hotkeys","showHotkeys"],components:{Icon:xe.Z,Tooltip:be.Z},data(){return{canRender:this.visible}},computed:{showRecycle:()=>I.route.paths[0]===_,author(){const e=this.script.meta.author;if(!e)return;const t=e.match(/^(.*?)\s<(\S*?@\S*?)>$/);return{email:t&&t[2],name:t?t[1]:e}},labelEnable(){return this.script.config.enabled?this.i18n("buttonDisable"):this.i18n("buttonEnable")},description(){return this.script.custom.description||(0,U.iQ)(this.script.meta,"description")},updatedAt(){const{props:e,config:t}=this.script,n={};let l;if(t.removed?({lastModified:l}=e):l=e.lastUpdated||e.lastModified,l){const e=new Date(l);n.show=(0,U.mr)(Date.now()-l),t.removed?n.title=this.i18n("labelRemovedAt",e.toLocaleString()):n.title=this.i18n("labelLastUpdatedAt",e.toLocaleString())}return n},tabIndex(){return this.focused?0:-1},url(){return`#${this.script.config.removed?_:o}/${this.script.props.id}`},urls(){return{home:[(0,U.ag)("buttonHome"),(0,U.t$)(this.script)],question:[(0,U.ag)("buttonSupport"),(0,U.b7)(this.script)]}}},watch:{visible(e){e&&(this.canRender=!0)},focused(e,t){const{$el:n}=this;if(e&&!t&&n){const e=n.getBoundingClientRect(),t=n.parentNode.getBoundingClientRect();let l=0;e.bottom>t.bottom-8?l+=e.bottom-t.bottom+8:e.top<t.top+8&&(l-=t.top-e.top+8),(0,Y.u7)(document.activeElement)||n.focus({preventScroll:!0}),this.$emit("scrollDelta",l)}}},methods:{onRemove(){this.$emit("remove",this.script)},onRestore(){this.$emit("restore",this.script)},onToggle(){this.$emit("toggle",this.script)},async onUpdate(){(-1!==this.script.$canUpdate||await(0,R.GW)((0,U.ag)("confirmManualUpdate")))&&this.$emit("update",this.script)},onFocus(){Y.$J.setContext("scriptFocus",!0)},onBlur(){Y.$J.setContext("scriptFocus",!1)},toggleTip(e){(0,Y.xr)(e.target)}}};var Wt=S(3744);const Tt=(0,Wt.Z)(It,[["render",(e,t,n,l,a,o)=>{const i=(0,W.up)("icon"),s=(0,W.up)("tooltip");return(0,W.wg)(),(0,W.iD)("div",{class:(0,T.C_)(["script",{disabled:!n.script.config.enabled,removed:n.script.config.removed,error:n.script.error,focused:n.focused,hotkeys:n.focused&&n.showHotkeys}]),tabIndex:o.tabIndex,onFocus:t[5]||(t[5]=(...e)=>o.onFocus&&o.onFocus(...e)),onBlur:t[6]||(t[6]=(...e)=>o.onBlur&&o.onBlur(...e))},[(0,W._)("div",gt,[(0,W._)("a",{href:o.url,"data-hotkey":n.hotkeys.edit,"data-hotkey-table":"",tabIndex:"-1"},[(0,W._)("img",{src:n.script.safeIcon,"data-no-icon":n.script.noIcon},null,8,vt)],8,ht)]),(0,W._)("div",ft,[(0,W._)("a",(0,W.dG)({textContent:(0,T.zw)(n.script.$cache.name)},n.viewTable&&{draggable:!1,href:o.url,tabIndex:o.tabIndex},{"data-order":n.script.config.removed?null:n.script.props.position,class:"ellipsis"}),null,16,wt)]),(0,W._)("div",bt,[a.canRender?((0,W.wg)(),(0,W.iD)(W.HY,{key:0},[o.author?((0,W.wg)(),(0,W.j4)(s,{key:0,content:e.i18n("labelAuthor")+n.script.meta.author,class:"script-author ml-1c hidden-sm",align:"end"},{default:(0,W.w5)(()=>[(0,W.Wm)(i,{name:"author"}),o.author.email?((0,W.wg)(),(0,W.iD)("a",{key:0,class:"ellipsis",href:`mailto:${o.author.email}`,textContent:(0,T.zw)(o.author.name),tabIndex:o.tabIndex},null,8,yt)):((0,W.wg)(),(0,W.iD)("span",{key:1,class:"ellipsis",textContent:(0,T.zw)(o.author.name)},null,8,xt))]),_:1},8,["content"])):(0,W.kq)("",!0),(0,W._)("span",{class:"version ellipsis",textContent:(0,T.zw)(n.script.meta.version)},null,8,Ct),n.script.config.removed?(0,W.kq)("",!0):((0,W.wg)(),(0,W.j4)(s,{key:1,class:"size hidden-sm",content:n.script.$cache.sizes,align:"end"},{default:(0,W.w5)(()=>[(0,W.Uk)((0,T.zw)(n.script.$cache.size),1)]),_:1},8,["content"])),(0,W.Wm)(s,{class:"updated hidden-sm ml-1c",content:o.updatedAt.title,align:"end"},{default:(0,W.w5)(()=>[(0,W.Uk)((0,T.zw)(o.updatedAt.show),1)]),_:1},8,["content"])],64)):(0,W.kq)("",!0)]),(0,W._)("div",_t,[a.canRender?((0,W.wg)(),(0,W.iD)(W.HY,{key:0},[(0,W.Wm)(s,{content:e.i18n("buttonEdit"),align:"start"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:"btn-ghost",href:o.url,"data-hotkey":n.hotkeys.edit,tabIndex:o.tabIndex},[(0,W.Wm)(i,{name:"code"})],8,kt)]),_:1},8,["content"]),n.script.config.removed?(0,W.kq)("",!0):((0,W.wg)(),(0,W.iD)(W.HY,{key:0},[(0,W.Wm)(s,{content:o.labelEnable,align:"start"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:"btn-ghost",onClick:t[0]||(t[0]=(...e)=>o.onToggle&&o.onToggle(...e)),"data-hotkey":n.hotkeys.toggle,tabIndex:o.tabIndex},[(0,W.Wm)(i,{name:"toggle-"+(n.script.config.enabled?"on":"off")},null,8,["name"])],8,St)]),_:1},8,["content"]),(0,W.Wm)(s,{disabled:!n.script.$canUpdate||n.script.checking,content:e.i18n("buttonCheckForUpdates"),align:"start"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:"btn-ghost",onClick:t[1]||(t[1]=(...e)=>o.onUpdate&&o.onUpdate(...e)),"data-hotkey":n.hotkeys.update,tabIndex:n.script.$canUpdate?o.tabIndex:-1},[(0,W.Wm)(i,{name:"refresh","^invert":-1===n.script.$canUpdate?"":null},null,8,["^invert"])],8,Ut)]),_:1},8,["disabled","content"])],64)),zt,(0,W.Wm)(s,{disabled:!o.description,content:o.description,align:"start"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:"btn-ghost",tabIndex:o.description?o.tabIndex:-1,onClick:t[2]||(t[2]=(...e)=>o.toggleTip&&o.toggleTip(...e))},[(0,W.Wm)(i,{name:"info"})],8,Dt)]),_:1},8,["disabled","content"]),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(o.urls,([e,t],n)=>((0,W.wg)(),(0,W.j4)(s,{key:n,disabled:!t,content:e,align:"start"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:"btn-ghost",target:"_blank",rel:"noopener noreferrer",href:t,tabIndex:t?o.tabIndex:-1},[(0,W.Wm)(i,{name:n},null,8,["name"])],8,$t)]),_:2},1032,["disabled","content"]))),128)),n.script.message?((0,W.wg)(),(0,W.iD)("div",{key:1,class:"script-message",textContent:(0,T.zw)(n.script.message),title:n.script.error},null,8,Rt)):(0,W.kq)("",!0)],64)):(0,W.kq)("",!0)]),(0,W._)("div",jt,[a.canRender?((0,W.wg)(),(0,W.iD)(W.HY,{key:0},[o.showRecycle||!n.script.config.removed?((0,W.wg)(),(0,W.j4)(s,{key:0,content:e.i18n("buttonRemove"),align:"end"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:(0,T.C_)(["btn-ghost",{"btn-danger":n.script.config.removed}]),onClick:t[3]||(t[3]=(...e)=>o.onRemove&&o.onRemove(...e)),"data-hotkey":n.hotkeys.remove,tabIndex:o.tabIndex},[(0,W.Wm)(i,{name:"trash"})],10,Ht)]),_:1},8,["content"])):(0,W.kq)("",!0),n.script.config.removed?((0,W.wg)(),(0,W.j4)(s,{key:1,content:e.i18n("buttonRestore"),placement:"left"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:"btn-ghost",onClick:t[4]||(t[4]=(...e)=>o.onRestore&&o.onRestore(...e)),"data-hotkey":n.hotkeys.restore,tabIndex:o.tabIndex},[(0,W.Wm)(i,{name:"undo"})],8,Et)]),_:1},8,["content"])):(0,W.kq)("",!0)],64)):(0,W.kq)("",!0)])],42,mt)}]]),Ot=Tt;var Mt=S(2327),At=S(6115),Vt=S(715);const Ft={class:"form-group condensed"},Lt=["textContent"],Pt=["textContent"],Yt=["textContent"],Zt=["disabled"],Bt=["textContent"],Nt=["textContent"],qt={__name:"settings-update",props:{script:c},setup(e){const t=e,n=(0,W.Fl)(()=>t.script.config),l=(0,W.Fl)(()=>!t.script._remote);return(e,t)=>((0,W.wg)(),(0,W.iD)("div",null,[(0,W._)("div",Ft,[(0,W._)("label",null,[(0,W.wy)((0,W._)("input",(0,W.dG)({type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>n.value.shouldUpdate=e)},{disabled:l.value}),null,16),[[Z.e8,n.value.shouldUpdate]]),(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelAllowUpdate"))},null,8,Lt),(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelNotifyThisUpdated")),class:"melt"},null,8,Pt)]),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)([[e.i18n("genericOn"),"1"],[e.i18n("genericOff"),"0"],[e.i18n("genericUseGlobal"),""]],([e,a])=>((0,W.wg)(),(0,W.iD)("label",{class:"ml-1 melt",key:a},[(0,W.wy)((0,W._)("input",(0,W.dG)({type:"radio"},{value:a,disabled:l.value},{"onUpdate:modelValue":t[1]||(t[1]=e=>n.value.notifyUpdates=e)}),null,16),[[Z.G2,n.value.notifyUpdates]]),(0,W.Uk)(),(0,W._)("span",{textContent:(0,T.zw)(e)},null,8,Yt)]))),128))]),(0,W._)("label",null,[(0,W.wy)((0,W._)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>n.value._editable=e),class:"scary-switch",disabled:l.value||!n.value.shouldUpdate},null,8,Zt),[[Z.e8,n.value._editable]]),(0,W._)("span",{textContent:(0,T.zw)(e.i18n("readonlyOpt"))},null,8,Bt),(0,W.Uk)(),(0,W._)("span",{textContent:(0,T.zw)(e.i18n("readonlyOptWarn"))},null,8,Nt)])]))}},Kt={class:"edit-settings"},Jt=["textContent"],Gt={class:"mb-2"},Xt=["textContent"],Qt=["textContent"],en=(0,W._)("td",null,[(0,W._)("code",null,"@run-at")],-1),tn=["textContent"],nn=["disabled"],ln=["textContent"],an=(0,W._)("option",{value:"document-start"},"document-start",-1),on=(0,W._)("option",{value:"document-body"},"document-body",-1),sn=(0,W._)("option",{value:"document-end"},"document-end",-1),rn=(0,W._)("option",{value:"document-idle"},"document-idle",-1),cn=(0,W._)("td",null,[(0,W._)("code",null,[(0,W.Uk)("@"),(0,W._)("s",{style:{color:"var(--fill-6)"}},"no"),(0,W.Uk)("frames")])],-1),un=["textContent"],dn=["disabled"],pn=["textContent"],mn=["textContent"],gn=["textContent"],hn=(0,W._)("td",null,[(0,W._)("code",null,"@inject-into")],-1),vn=["textContent"],fn=["disabled"],wn=["textContent"],bn=["textContent"],yn=["textContent"],xn=["textContent"],Cn=["onUpdate:modelValue","placeholder","disabled"],_n=["textContent"],kn=["textContent"],Sn=["textContent"],Un=["onUpdate:modelValue","disabled"],zn=["textContent"],Dn=["onUpdate:modelValue","rows","disabled"],$n="downloadURL",Rn="homepageURL",jn="updateURL",Hn={__name:"settings",props:{script:c,readOnly:s},setup(e){const t=e,n=(0,H.XI)(Vt.Wg),l=e=>{var t;return(null==(t=e.match(/^(.*?)(@[-a-z]+)(.*)/))?void 0:t.slice(1))||[e,"",""]},a=(0,W.Fl)(()=>t.script.config),o=(0,W.Fl)(()=>t.script.custom),i=(0,W.Fl)(()=>{const{script:e}=t,{meta:n}=e;return{name:n.name,[Rn]:(0,U.t$)(e),[jn]:n[jn]||(0,U.ag)("hintUseDownloadURL"),[$n]:n[$n]||e.custom.lastInstallURL}}),s=[["name",(0,U.ag)("labelName")],[Rn,(0,U.ag)("labelHomepageURL")],[jn,(0,U.ag)("labelUpdateURL")],[$n,(0,U.ag)("labelDownloadURL")]],r=[["include","origInclude",...l((0,U.ag)("labelInclude"))],["match","origMatch",...l((0,U.ag)("labelMatch"))],["exclude","origExclude",...l((0,U.ag)("labelExclude"))],["excludeMatch","origExcludeMatch",...l((0,U.ag)("labelExcludeMatch"))]];return(t,l)=>((0,W.wg)(),(0,W.iD)("div",Kt,[(0,W._)("h4",{textContent:(0,T.zw)((0,H.SU)(U.ag)("editLabelSettings"))},null,8,Jt),(0,W._)("div",Gt,[(0,W._)("label",null,[(0,W.wy)((0,W._)("input",{type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=e=>a.value.enabled=e)},null,512),[[Z.e8,a.value.enabled]]),(0,W._)("span",{textContent:(0,T.zw)((0,H.SU)(U.ag)("buttonEnable"))},null,8,Xt)])]),(0,W.Wm)((0,H.SU)(qt),(0,T.vs)((0,W.F4)({script:e.script})),null,16),(0,W._)("h4",{textContent:(0,T.zw)((0,H.SU)(U.ag)("editLabelMeta"))},null,8,Qt),(0,W._)("table",null,[(0,W._)("tr",null,[en,(0,W._)("td",null,[(0,W._)("p",{textContent:(0,T.zw)((0,H.SU)(U.ag)("labelRunAt"))},null,8,tn)]),(0,W._)("td",null,[(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>o.value.runAt=e),disabled:e.readOnly},[(0,W._)("option",{value:"",textContent:(0,T.zw)((0,H.SU)(U.ag)("labelRunAtDefault"))},null,8,ln),an,on,sn,rn],8,nn),[[Z.bM,o.value.runAt]])])]),(0,W._)("tr",null,[cn,(0,W._)("td",null,[(0,W._)("p",{textContent:(0,T.zw)((0,H.SU)(U.ag)("labelNoFrames"))},null,8,un)]),(0,W._)("td",null,[(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>o.value.noframes=e),disabled:e.readOnly},[(0,W._)("option",{value:"",textContent:(0,T.zw)((0,H.SU)(U.ag)("labelRunAtDefault"))},null,8,pn),(0,W._)("option",{value:"0",textContent:(0,T.zw)((0,H.SU)(U.ag)("genericOn"))},null,8,mn),(0,W._)("option",{value:"1",textContent:(0,T.zw)((0,H.SU)(U.ag)("genericOff"))},null,8,gn)],8,dn),[[Z.bM,o.value.noframes]])])]),(0,W._)("tr",null,[hn,(0,W._)("td",null,[(0,W._)("p",{textContent:(0,T.zw)((0,H.SU)(U.ag)("labelInjectionMode"))},null,8,vn)]),(0,W._)("td",null,[(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":l[3]||(l[3]=e=>o.value.injectInto=e),disabled:e.readOnly},[(0,W._)("option",{value:"",textContent:(0,T.zw)((0,H.SU)(U.ag)("labelRunAtDefault"))},null,8,wn),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(n.value,(e,t)=>((0,W.wg)(),(0,W.iD)("option",{key:t,textContent:(0,T.zw)(t)},null,8,bn))),128))],8,fn),[[Z.bM,o.value.injectInto]])])]),((0,W.wg)(),(0,W.iD)(W.HY,null,(0,W.Ko)(s,([t,n])=>(0,W._)("tr",{key:t},[(0,W._)("td",null,[(0,W._)("code",{textContent:(0,T.zw)(`@${t}`)},null,8,yn)]),(0,W._)("td",null,[(0,W._)("p",{textContent:(0,T.zw)(n)},null,8,xn)]),(0,W._)("td",null,[(0,W.wy)((0,W._)("input",{type:"text","onUpdate:modelValue":e=>o.value[t]=e,placeholder:i.value[t],disabled:e.readOnly},null,8,Cn),[[Z.nr,o.value[t]]])])])),64))]),(0,W._)("table",null,[((0,W.wg)(),(0,W.iD)(W.HY,null,(0,W.Ko)(r,([n,l,a,i,s])=>(0,W._)("tr",{key:n},[(0,W._)("td",null,[(0,W._)("p",null,[(0,W._)("span",{textContent:(0,T.zw)(a)},null,8,_n),(0,W._)("code",{textContent:(0,T.zw)(i)},null,8,kn),(0,W._)("span",{textContent:(0,T.zw)(s)},null,8,Sn)]),(0,W._)("label",null,[(0,W.wy)((0,W._)("input",{type:"checkbox","onUpdate:modelValue":e=>o.value[l]=e,disabled:e.readOnly},null,8,Un),[[Z.e8,o.value[l]]]),(0,W._)("span",{textContent:(0,T.zw)((0,H.SU)(U.ag)("labelKeepOriginal"))},null,8,zn)])]),(0,W._)("td",null,[(0,W.wy)((0,W._)("textarea",{"onUpdate:modelValue":e=>o.value[n]=e,spellcheck:"false",rows:t.calcRows(o.value[n]),disabled:e.readOnly},null,8,Dn),[[Z.nr,o.value[n]]])])])),64))])]))}},En=["data-editing"],In={class:"mb-1"},Wn={key:1,class:"inline-block ml-2"},Tn=["disabled"],On=["textContent"],Mn=["textContent"],An=["disabled"],Vn={class:"ml-2 mr-2c"},Fn=(0,W._)("kbd",null,"PageUp",-1),Ln=(0,W._)("kbd",null,"PageDown",-1),Pn=(0,W._)("kbd",null,"\u2191",-1),Yn=(0,W._)("kbd",null,"\u2193",-1),Zn=(0,W._)("kbd",null,"Tab",-1),Bn=(0,W._)("kbd",null,"Shift-Tab",-1),Nn=(0,W._)("kbd",null,"Enter",-1),qn=(0,W._)("kbd",null,"Ctrl-Del",-1),Kn=["onKeydown"],Jn=["textContent"],Gn=["onKeydown","onClick"],Xn={class:"ellipsis"},Qn=["textContent"],el=["textContent"],tl=["textContent"],nl=["onClick"],ll=["textContent"],al=["onKeydown"],ol=["onClick"],il=["textContent"],sl=["textContent"],rl=["textContent"],cl=["textContent"],ul={key:3,class:"edit-values-panel flex flex-col mb-1c"},dl={class:"control"},pl=["textContent"],ml=["textContent","onClick","title","disabled"],gl=["textContent"],hl=["textContent"],vl=["readOnly","onKeydown"],fl=["textContent"],wl={__name:"values",props:{script:c,readOnly:s},setup(e){const t=e,n=(0,H.iH)(),l=(0,H.iH)(),a=(0,H.iH)(),o=(0,H.iH)(),i=(0,H.iH)(),s=(0,H.iH)(),r=(0,H.iH)(!0),u=(0,H.iH)(),h=(0,H.iH)(),v=(0,H.iH)(),w={error:"",dirty:!1},b=e=>e.length>1024?e.slice(0,1024):e,y=e=>{try{return JSON.stringify(JSON.parse(e),null,"  ")}catch(t){return e}},x={condition:"!edit"},C=e=>Y.$J.setContext("edit","selectionEnd"in e.target),_=(0,W.Fl)(()=>c.keys(h.value||{}).sort()),S=(0,W.Fl)(()=>Math.ceil(_.value.length/25)),z=(0,W.Fl)(()=>{const e=25*(u.value-1);return _.value.slice(e,e+25)});let D,$,j,E,O;function M(e){(0,W.Y3)(()=>{l.value[e?"click":"focus"]()})}function A(e){u.value=Math.max(1,Math.min(S.value,u.value+e))}function V(e,t){const n=e.length+(h.value[e]||t).length-1;return n<1e4?n:(0,U.aj)(n)}function F(e,t,n){let l=h.value[e]||n;const a=l[0];return l=l.slice(1),"s"===a?l=JSON.stringify(l):t||(l=y(l)),t?b(l):l}function L(){return`{\n  ${_.value.map(e=>`${JSON.stringify(e)}: ${F(e)}`).join(",\n").replace(/\n/g,"\n  ")}\n}`}function P(e={}){if(!(0,fe.vZ)(h.value,e))return h.value=e,u.value=Math.min(u.value,S.value)||1,B(),!0}function B(){I.storageSize=_.value.reduce((e,t)=>e+t.length+4+h.value[t].length+2,2)}async function N({key:e,jsonValue:n,rawValue:l=(0,U.bd)(n)||""}){const{id:a}=t.script.props;await(0,U.gj)("UpdateValue",{id:a,key:e,raw:l},void 0,E),l?h.value[e]=l:delete h.value[e],B()}function q(){s.value={isNew:!0,key:"",value:"",...w}}async function K(e){var t;N({key:e}),(v.value||(v.value={}))[e+Math.random()]={key:e,rawValue:h.value[e],cut:F(e,!0),len:V(e)},(null==(t=s.value)?void 0:t.key)===e&&(s.value=null)}function J(e){const t=v.value,n=t[e];delete t[e],(0,U.xb)(t)&&(v.value=null),N(n)}function G(e){s.value={key:e,value:F(e),...w}}function X(){s.value={isAll:!0,value:L(),...w}}async function Q(e){const n=s.value;if(n.jsonPaused&&(n.jsonPaused=!1,te()),n.error){const e=n.errorPos;return D.setSelection(e,{line:e.line,ch:e.ch+1}),D.focus(),void(0,R.PV)({text:n.error})}1===e?(D.markClean(),n.dirty=!1):s.value=null,n.isAll?await(0,U.gj)("SetValueStores",{[t.script.props.id]:f(fe.Xw,n.jsonValue,e=>(0,U.bd)(e)||"")}):await N(n)}function ee(){const e=s.value;if(e.dirty){const t=`${e.key} ${1e9*Math.random()|0}`,n=D.getValue(),l=(0,U.bd)(n);(v.value||(v.value={}))[t]={key:t,rawValue:l,cut:b(n),len:V(t,l)}}s.value=null}function te(e){const t=s.value;if(t.dirty=e,t.error=null,t.jsonPaused)return;const n=g.now();try{const e=D.getValue();t.jsonValue=e.trim()?JSON.parse(e):void 0}catch(e){const n=/(position\s+)(\d+)|$/,l=D.posFromIndex(+`${e}`.match(n)[2]||0);t.error=`${e}`.replace(n,`$1${l.line+1}:${l.ch+1}`),t.errorPos=l,t.jsonValue=void 0}t.jsonPaused=g.now()-n>10}function ne(e){const t=c.values(e)[0].newValue;if(t){const e=s.value,n=null==e?void 0:e.key,l=e&&(e.isAll?L:F);if(P(t instanceof c?t:(0,fe.p$)(t)),e){const t=l(n);D.getValue()===t?(e.isNew=!1,e.dirty=!1):e.dirty||(e.value=t,te())}}else P(t)}function le(e){(0,Y.nk)(("ArrowDown"===e.key?1:e.target!==l.value&&-1)||0)}return(0,W.dl)(()=>{var e;const l=n.value,{id:a}=t.script.props,o=(0,U.K0)();f(d,l,"focusin",C),null==(e=s.value?D:j)||e.focus(),(0,U.gj)("GetValueStore",a,void 0,E={tab:{id:Math.random()-2},[k]:0}).then(e=>{const t=!h.value;P(e)&&t&&_.value.length&&M(!0),r.value=!1}),$=[()=>f(p,l,"focusin",C),Y.$J.register("pageup",()=>A(-1),x),Y.$J.register("pagedown",()=>A(1),x)],O=m.runtime.connect({name:Vt.vy+JSON.stringify({cfg:{value:a},id:null==o?void 0:o[Vt.vy](ne),tabId:E.tab.id})}),o||O.onMessage.addListener(ne),i.value=!0}),(0,W.se)(()=>{var e,t;i.value=!1,null==(e=$)||e.forEach(e=>e()),null==(t=O)||t.disconnect(),$=O=null}),(0,W.YP)(s,(e,t)=>{if(e)j=document.activeElement,(0,W.Y3)(()=>{const n=o.value;if(D=n.cm,t&&n.updateValue(e.value),e.isNew){const e=a.value;e.setSelectionRange(0,0),e.focus()}else D.setCursor(0,0),D.focus()});else if(t){var n;null==(n=j)||n.focus()}}),(0,W.YP)(u,()=>{j=null,M()}),(t,c)=>((0,W.wg)(),(0,W.iD)("div",{class:"edit-values",ref_key:"$el",ref:n,"data-editing":s.value&&""},[(0,W._)("div",In,[e.readOnly?(0,W.kq)("",!0):((0,W.wg)(),(0,W.iD)("button",{key:0,onClick:q},"+")),S.value>1?((0,W.wg)(),(0,W.iD)("div",Wn,[(0,W._)("button",{disabled:1===u.value,onClick:c[0]||(c[0]=e=>u.value-=1)},"\u2190",8,Tn),(0,W._)("span",{class:"ml-1",textContent:(0,T.zw)(u.value)},null,8,On),(0,W.Uk)(" / "),(0,W._)("span",{class:"mr-1",textContent:(0,T.zw)(S.value)},null,8,Mn),(0,W._)("button",{disabled:u.value>=S.value,onClick:c[1]||(c[1]=e=>u.value+=1)},"\u2192",8,An)])):(0,W.kq)("",!0),(0,W._)("span",Vn,[(0,W._)("span",null,[S.value>1?((0,W.wg)(),(0,W.iD)(W.HY,{key:0},[Fn,(0,W.Uk)(", "),Ln,(0,W.Uk)(", ")],64)):(0,W.kq)("",!0),Pn,(0,W.Uk)(", "),Yn,(0,W.Uk)(", "),Zn,(0,W.Uk)(", "),Bn,(0,W.Uk)(", ")]),(0,W._)("span",null,[Nn,(0,W.Uk)(": "+(0,T.zw)(t.i18n("buttonEdit"))+",",1)]),(0,W._)("span",null,[qn,(0,W.Uk)(": "+(0,T.zw)(t.i18n("buttonRemove")),1)])])]),(0,W._)("div",{class:"edit-values-table main",onKeydown:[(0,Z.D2)((0,Z.iM)(le,["exact"]),["down"]),(0,Z.D2)((0,Z.iM)(le,["exact"]),["up"])]},[(0,W._)("a",{ref_key:"$editAll",ref:l,class:"edit-values-row flex",onClick:X,tabindex:"0",textContent:(0,T.zw)(t.i18n("editValueAllHint"))},null,8,Jn),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(z.value,e=>((0,W.wg)(),(0,W.iD)("div",{key:e,class:"edit-values-row flex monospace-font",onKeydown:(0,Z.D2)((0,Z.iM)(t=>K(e),["ctrl","exact"]),["delete"]),onClick:t=>G(e)},[(0,W._)("div",Xn,[(0,W._)("a",{textContent:(0,T.zw)(e),tabindex:"0"},null,8,Qn)]),(0,W._)("div",{class:"ellipsis flex-auto",textContent:(0,T.zw)(F(e,!0))},null,8,el),(0,W._)("pre",{textContent:(0,T.zw)(V(e))},null,8,tl),(0,W._)("div",{class:"del",onClick:(0,Z.iM)(t=>K(e),["stop"])},[(0,W.Wm)((0,H.SU)(xe.Z),{name:"trash"})],8,nl)],40,Gn))),128))],40,Kn),v.value?((0,W.wg)(),(0,W.iD)("h3",{key:0,textContent:(0,T.zw)(t.i18n("headerRecycleBin"))},null,8,ll)):(0,W.kq)("",!0),v.value?((0,W.wg)(),(0,W.iD)("div",{key:1,class:"edit-values-table trash monospace-font",onKeydown:[(0,Z.D2)((0,Z.iM)(le,["exact"]),["down"]),(0,Z.D2)((0,Z.iM)(le,["exact"]),["up"])]},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(v.value,({key:e,cut:t,len:n},l)=>((0,W.wg)(),(0,W.iD)("div",{key:l,class:"edit-values-row flex",onClick:e=>J(l)},[(0,W._)("a",{class:"ellipsis",textContent:(0,T.zw)(e),tabindex:"0"},null,8,il),(0,W._)("s",{class:"ellipsis flex-auto",textContent:(0,T.zw)(t)},null,8,sl),(0,W._)("pre",{textContent:(0,T.zw)(n)},null,8,rl)],8,ol))),128))],40,al)):(0,W.kq)("",!0),r.value||_.value.length?(0,W.kq)("",!0):((0,W.wg)(),(0,W.iD)("div",{key:2,class:"edit-values-empty mt-1",textContent:(0,T.zw)(t.i18n("noValues"))},null,8,cl)),s.value?((0,W.wg)(),(0,W.iD)("div",ul,[(0,W._)("div",dl,[(0,W._)("h4",{textContent:(0,T.zw)(s.value.isAll?t.i18n("labelEditValueAll"):t.i18n("labelEditValue"))},null,8,pl),(0,W._)("div",null,[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)([t.i18n("buttonOK"),t.i18n("buttonApply")],(e,t)=>((0,W.wg)(),(0,W.iD)("button",{key:e,textContent:(0,T.zw)(e),onClick:e=>Q(t),class:(0,T.C_)({"has-error":s.value.error,"save-beacon":!t}),title:s.value.error,disabled:s.value.error||!s.value.dirty},null,10,ml))),128)),(0,W._)("button",{textContent:(0,T.zw)(t.i18n("buttonCancel")),onClick:ee},null,8,gl)])]),(0,W.wy)((0,W._)("label",null,[(0,W._)("span",{textContent:(0,T.zw)(t.i18n("valueLabelKey"))},null,8,hl),(0,W.wy)((0,W._)("input",{type:"text","onUpdate:modelValue":c[2]||(c[2]=e=>s.value.key=e),readOnly:!s.value.isNew||e.readOnly,ref_key:"$key",ref:a,spellcheck:"false",onKeydown:(0,Z.D2)((0,Z.iM)(ee,["exact","stop"]),["esc"])},null,40,vl),[[Z.nr,s.value.key]])],512),[[Z.F8,!s.value.isAll]]),(0,W._)("label",null,[(0,W._)("span",{textContent:(0,T.zw)(s.value.isAll?t.i18n("valueLabelValueAll"):t.i18n("valueLabelValue"))},null,8,fl),(0,W.Wm)((0,H.SU)(Mt.default),{value:s.value.value,ref_key:"$value",ref:o,class:"h-100 mt-1",mode:"application/json",readOnly:e.readOnly,onCodeDirty:te,commands:{close:ee,save:Q},active:i.value,focusme:""},null,8,["value","readOnly","commands","active"])])])):(0,W.kq)("",!0)],8,En))}},bl=wl,yl={class:"edit-help mb-2c"},xl=["innerHTML"],Cl=(0,W._)("a",{href:"https://violentmonkey.github.io/api/",rel:"noopener noreferrer",target:"_blank"},"violentmonkey.github.io/api/",-1),_l={class:"keyboard"},kl=["textContent"],Sl=["textContent"],Ul=["textContent"],zl={__name:"help",props:{hotkeys:Array},setup:e=>(t,n)=>((0,W.wg)(),(0,W.iD)("div",yl,[(0,W._)("div",null,[(0,W._)("h3",{innerHTML:t.i18n("editHelpDocumention")},null,8,xl),Cl]),(0,W._)("div",_l,[(0,W._)("h3",{textContent:(0,T.zw)(t.i18n("editHelpKeyboard"))},null,8,kl),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(e.hotkeys,([e,t])=>((0,W.wg)(),(0,W.iD)("dl",{key:e},[(0,W._)("dt",{class:"monospace-font",textContent:(0,T.zw)(e)},null,8,Sl),(0,W._)("dd",{textContent:(0,T.zw)(t)},null,8,Ul)]))),128))])]))},Dl={class:"edit-header flex mr-1c"},$l=["textContent","onClick"],Rl={class:"edit-name text-center ellipsis flex-1"},jl=["textContent"],Hl=["textContent"],El={key:1,class:"edit-hint text-right ellipsis"},Il=["href","textContent"],Wl={class:"mr-1"},Tl=["textContent","disabled","title"],Ol=["textContent","disabled"],Ml=["textContent"],Al={key:0,class:"frozen-note shelf mr-2c flex flex-wrap"},Vl=["textContent"],Fl={key:1,class:"shelf fatal"},Ll=["textContent"],Pl={key:2,class:"errors shelf my-1c"},Yl=["textContent"],Zl={class:"my-1"},Bl=["href","textContent"],Nl={__name:"index",props:{initial:c,initialCode:String,readOnly:s},emits:["close"],setup(t,{emit:n}){const o=t;let i,r,u,p,g,h,v;const y=(0,H.iH)(),x=(0,H.iH)(),C=(0,H.iH)("code"),_=(0,H.iH)(!1),k=(0,H.iH)(),S=(0,H.iH)(""),z=(0,H.iH)(!1),D={save:ee,close:te},j=(0,H.iH)(),O=(0,H.iH)(),M=(0,H.iH)(),A=(0,H.iH)(!1),V=(0,H.iH)(!1),F=(0,H.iH)("https://violentmonkey.github.io/api/matching/"),L=(0,W.Fl)(()=>{const{meta:e,props:{id:t}}=k.value,n=e.require.length&&"@require",l=!(0,U.xb)(e.resources)&&"@resource",a=I.storageSize;return{code:(0,U.ag)("editNavCode"),settings:(0,U.ag)("editNavSettings"),...t&&{values:(0,U.ag)("editNavValues")+(a?` (${(0,U.aj)(a)})`:"")},...(n||l)&&{externals:f(U.Hv,[n,l],"/")},help:"?"}}),P=(0,W.Fl)(()=>I.title=(0,U.pV)(k.value));(0,W.YP)(C,async e=>{await(0,W.Y3)(),"code"===e?i.focus():(0,R.wO)(x.value.$el)},{immediate:!0}),(0,W.YP)(_,e=>{v(e),Y.$J.setContext("canSave",e)}),(0,W.YP)(()=>o.initial.error,e=>{e&&(0,R.PV)({text:`${o.initial.message}\n\n${e}`})}),(0,W.YP)(z,se),(0,W.YP)(k,e=>{const{custom:t,config:n}=e,{shouldUpdate:l}=n;n._editable=2===l,n.enabled=!!n.enabled,n.shouldUpdate=!!l,n.notifyUpdates=(0,U.jd)(n.notifyUpdates),t.noframes=(0,U.jd)(t.noframes);for(const e in B)null==t[e]&&(t[e]=B[e]);for(let e=0;e<J.length;e++){const n=J[e];t[n]||(t[n]="")}for(let e=0;e<q.length;e++){const n=q[e],l=t[n];t[n]=l?`${l.join("\n")}${l.length?"\n":""}`:""}ie(),n.removed||(g=(0,fe.p$)(e))});const B={name:"",homepageURL:"",updateURL:"",downloadURL:"",origInclude:!0,origExclude:!0,origMatch:!0,origExcludeMatch:!0},N=e=>""!==e?e:null,q=["include","match","exclude","excludeMatch"],K=e=>e.trim()?e.split("\n").map(e=>e.trim()).filter(s):null,J=[l,a],G=e=>e||null,X=(e,t)=>e<t?-1:e>t,Q=({shouldUpdate:e,_editable:t})=>+e&&e+t;{const e=o.initial;S.value=o.initialCode,k.value=(0,fe.p$)(e),(0,W.YP)(()=>k.value.config,ie,{deep:!0}),(0,W.YP)(()=>k.value.custom,ie,{deep:!0})}async function ee(){if(!_.value)return;h&&re();const e=k.value,{config:t,custom:n}=e,{notifyUpdates:l}=t,{noframes:a}=n;try{var o;const s=e.props.id,u=await(0,U.gj)("ParseScript",{id:s,code:r.getRealContent(),config:{enabled:+t.enabled,notifyUpdates:l?+l:null,shouldUpdate:Q(t)},custom:{...(0,fe.zr)(n,c.keys(B),N),...(0,fe.zr)(n,q,K),...(0,fe.zr)(n,J,G),noframes:a?+a:null},isNew:!s,message:""}),d=null==u||null==(o=u.where)?void 0:o.id;i.markClean(),z.value=!1,_.value=!1,V.value=!1,O.value=u.errors,k.value=u.update,d&&!s&&history.replaceState(null,P.value,`${b}/${d}`),M.value=null}catch(e){M.value=e.message.split("\n")}}function te(){var e;"code"!==C.value?C.value="code":(n("close"),w&&(null==(e=document.activeElement)||e.blur()))}function ne(){ee().then(te)}function le(e){const t=c.keys(L.value);C.value=t[(t.indexOf(C.value)+e+t.length)%t.length]}function ae(){le(-1)}function oe(){le(1)}function ie(e){const t=k.value,{config:n}=t,{removed:l}=n,a=(t._remote=!!(0,U.TZ)(t))&&Q(n),i=!(!l&&1!==a&&!o.readOnly);A.value=i,V.value=!l&&(i||a>=1),!l&&e&&se()}function se(){_.value=z.value||!(0,fe.vZ)(k.value,g)}async function re(e){$.Z.get("editorWindow")&&(e||(e=await(null==U.oy?void 0:U.oy.getCurrent())||{}),"normal"===e.state&&$.Z.set("editorWindowPos",(0,fe.zr)(e,["left","top","width","height"])))}function ce({id:e,tabs:t}){if(1===t.length){const{onBoundsChanged:t}=m.windows;t?t.addListener(t=>{t.id===e&&re(t)}):(d("resize",(0,U.Ds)(re,100)),h=!0)}}return(0,W.bv)(()=>{var t,n;r=y.value,i=r.cm,v=(0,E.Q$)(null,()=>i.focus()),$.Z.get("editorWindow")&&1===e.history.length&&(null==(n=browser.windows)||n.getCurrent({populate:!0}).then(ce)),I.storageSize=0;const l=c.values(L.value),a=j.value=[["Alt-PageUp",` ${l.join(" < ")}`],["Alt-PageDown",` ${l.join(" > ")}`],...c.entries(r.expandKeyMap()).sort((e,t)=>X(e[1],t[1])||X(e[0],t[0]))];p=null==(t=a.find(([,e])=>"save"===e))?void 0:t[0],p||(p="Ctrl-S",a.unshift([p,"save"]))}),(0,W.dl)(()=>{document.body.classList.add("edit-open"),u=[Y.$J.register("a-pageup",ae),Y.$J.register("a-pagedown",oe),Y.$J.register(p.replace(/(?:Ctrl|Cmd)-/i,"ctrlcmd-"),ee),Y.$J.register("escape",te),Y.$J.register("f1",()=>{C.value="help"})],I.title=P.value}),(0,W.se)(()=>{var e;document.body.classList.remove("edit-open"),I.title=null,v(!1),null==(e=u)||e.forEach(e=>e())}),(e,n)=>((0,W.wg)(),(0,W.iD)("div",{class:(0,T.C_)(["edit frame flex flex-col abs-full",{frozen:A.value}])},[(0,W._)("div",Dl,[(0,W._)("nav",null,[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(L.value,(e,t)=>((0,W.wg)(),(0,W.iD)("div",{key:t,class:(0,T.C_)(["edit-nav-item",{active:C.value===t}]),textContent:(0,T.zw)(e),onClick:e=>C.value=t},null,10,$l))),128))]),(0,W._)("div",Rl,[k.value.config.removed?((0,W.wg)(),(0,W.iD)("span",{key:0,class:"subtle",textContent:(0,T.zw)((0,H.SU)(U.ag)("headerRecycleBin")+" / ")},null,8,jl)):(0,W.kq)("",!0),(0,W.Uk)(" "+(0,T.zw)(P.value),1)]),A.value&&"code"===C.value?((0,W.wg)(),(0,W.iD)("p",{key:0,textContent:(0,T.zw)((0,H.SU)(U.ag)("readonly")),class:"text-upper text-right text-red"},null,8,Hl)):((0,W.wg)(),(0,W.iD)("div",El,[(0,W._)("a",{href:(0,H.SU)(R.XB),target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)((0,H.SU)(U.ag)("editHowToHint"))},null,8,Il)])),(0,W._)("div",Wl,[(0,W.wy)((0,W._)("button",{textContent:(0,T.zw)((0,H.SU)(U.ag)("buttonSave")),onClick:ee,disabled:!_.value,class:(0,T.C_)({"has-error":e.$fe=M.value||O.value}),title:e.$fe},null,10,Tl),[[Z.F8,_.value||!A.value]]),(0,W.wy)((0,W._)("button",{textContent:(0,T.zw)((0,H.SU)(U.ag)("buttonSaveClose")),onClick:ne,disabled:!_.value},null,8,Ol),[[Z.F8,_.value||!A.value]]),(0,W._)("button",{textContent:(0,T.zw)((0,H.SU)(U.ag)("buttonClose")),onClick:te},null,8,Ml)])]),V.value&&"code"===C.value?((0,W.wg)(),(0,W.iD)("div",Al,[(0,W._)("p",{textContent:(0,T.zw)((0,H.SU)(U.ag)("readonlyNote"))},null,8,Vl),((0,W.wg)(),(0,W.j4)(W.Ob,null,[(0,W.Wm)((0,H.SU)(qt),{class:"flex ml-2c",script:k.value},null,8,["script"])],1024))])):(0,W.kq)("",!0),M.value?((0,W.wg)(),(0,W.iD)("p",Fl,[(0,W._)("b",{textContent:(0,T.zw)(M.value[0])},null,8,Ll),(0,W.Uk)(" "+(0,T.zw)(M.value[1]),1)])):(0,W.kq)("",!0),(0,W.wy)((0,W.Wm)((0,H.SU)(Mt.default),{class:(0,T.C_)(["flex-auto",{readonly:A.value}]),value:S.value,readOnly:A.value,ref_key:"$code",ref:y,active:"code"===C.value,commands:D,onCodeDirty:n[0]||(n[0]=e=>z.value=e)},null,8,["class","value","readOnly","active"]),[[Z.F8,"code"===C.value]]),((0,W.wg)(),(0,W.j4)(W.Ob,{ref_key:"$tabBody",ref:x},["settings"===C.value?((0,W.wg)(),(0,W.j4)((0,H.SU)(Hn),(0,W.dG)({key:0,class:"edit-body"},{readOnly:t.readOnly,script:k.value}),null,16)):"values"===C.value?((0,W.wg)(),(0,W.j4)((0,H.SU)(bl),(0,W.dG)({key:1,class:"edit-body"},{readOnly:t.readOnly,script:k.value}),null,16)):"externals"===C.value?((0,W.wg)(),(0,W.j4)((0,H.SU)(At.Z),{key:2,class:"flex-auto",value:k.value},null,8,["value"])):"help"===C.value?((0,W.wg)(),(0,W.j4)((0,H.SU)(zl),{key:3,class:"edit-body",hotkeys:j.value},null,8,["hotkeys"])):(0,W.kq)("",!0)],1536)),O.value?((0,W.wg)(),(0,W.iD)("div",Pl,[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(O.value,e=>((0,W.wg)(),(0,W.iD)("p",{key:e,textContent:(0,T.zw)(e),class:"text-red"},null,8,Yl))),128)),(0,W._)("p",Zl,[(0,W._)("a",{href:F.value,target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(F.value)},null,8,Bl)])])):(0,W.kq)("",!0)],2))}},ql=Nl,Kl={sort:{exec:{title:(0,U.ag)("filterExecutionOrder")},alpha:{title:(0,U.ag)("filterAlphabeticalOrder"),compare:({$cache:{lowerName:e}},{$cache:{lowerName:t}})=>e<t?-1:e>t},update:{title:(0,U.ag)("filterLastUpdateOrder"),compare:({props:{lastUpdated:e}},{props:{lastUpdated:t}})=>(+t||0)-(+e||0)},size:{title:(0,U.ag)("filterSize"),compare:(e,t)=>t.$cache.sizeNum-e.$cache.sizeNum}}},Jl=(0,H.qj)({searchScope:null,showEnabledFirst:null,showOrder:null,viewSingleColumn:null,viewTable:null,sort:null}),Gl=e=>Jl.showEnabledFirst?(t,n)=>n.config.enabled-t.config.enabled||e(t,n):e;f(fe.SE,Jl,e=>{(0,ve.Z)(`filters.${e}`,t=>{Jl[e]=t,"sort"!==e||Kl.sort[t]||(Jl[e]=c.keys(Kl.sort)[0])})});const Xl="tabScripts",Ql=`${Xl} && inputFocus`,ea=`${Xl} && !inputFocus`,ta=`${ea} && selectedScript && !showRecycle`,na=`${ea} && selectedScript && showRecycle`,la=`${ea} && !buttonFocus`,aa=`${ea} && selectedScript && showHotkeys`,oa={edit:"e",toggle:"space",update:"r",restore:"r",remove:"x"},ia=(e,t)=>t.map(([t,n,l])=>Y.$J.register(t,e,{condition:n,caseSensitive:l})),sa=100;let ra,ca=0,ua=[],da=[];const pa=(0,H.iH)(),ma=(0,H.iH)(),ga=(0,H.iH)(),ha=(0,H.qj)({focusedIndex:-1,menuNewActive:!1,showHotkeys:!1,search:"",searchError:null,sortedScripts:[],filteredScripts:[],script:null,code:"",numColumns:1,batchRender:{limit:ca}}),va=(0,W.Fl)(()=>I.route.paths[0]===_),fa=(0,W.Fl)(()=>!va.value&&"exec"===Jl.sort),wa=(0,W.Fl)(()=>R.T&&fa.value),ba=(0,W.Fl)(()=>{var e;return null==(e=Kl.sort[Jl.sort])?void 0:e.compare}),ya=(0,W.Fl)(()=>ha.filteredScripts[ha.focusedIndex]),xa=(0,W.Fl)(()=>I.loading||(ha.search?ha.sortedScripts.find(e=>!1!==e.$cache.show):ha.sortedScripts.length)?null:(0,U.ag)("labelNoSearchScripts")),Ca=(0,W.Fl)(()=>ha.search&&["code","all"].includes(Jl.searchScope)&&I.scripts.filter(e=>null==e.$cache.code).map(e=>e.props.id)),_a=()=>va.value?I.removedScripts:I.scripts,ka=(0,U.Ds)(Da,100),Sa=(0,U.Ds)(Oa);function Ua(){!va.value&&I.needRefresh&&(I.scripts=I.scripts.filter(e=>!e.config.removed),I.needRefresh=!1),ha.focusedIndex=-1,Da()}async function za(){const e=Ca.value;null!=e&&e.length&&await Va(e),Da(),Ta()}function Da(){const e=[..._a()],t=ha.search?Ma(e):e.length,n=ba.value;n&&e.sort(Gl(n)),ha.sortedScripts=e,ha.filteredScripts=ha.search?e.filter(({$cache:e})=>e.show):e,Ya(ha.focusedIndex),!ca||t<ca?Oa():Sa()}function $a(){(0,U.gj)("CheckUpdate")}async function Ra(){try{var e;let t=await(0,R.GW)((0,U.ag)("hintInputURL"),{input:"",ok:{type:"submit"}});t=null==(e=t)?void 0:e.trim(),t&&(t.includes("://")||(t=`https://${t}`),new URL(t),await(0,U.gj)("ConfirmInstall",{url:t}))}catch(e){e&&(0,R.PV)({text:e})}}async function ja(e,t){if(e===t)return;const n=ha.filteredScripts,l=I.scripts,a=n[e],o=l.indexOf(a),i=l.indexOf(n[t]),{id:s}=a.props;await(0,U.gj)("Move",{id:s,offset:i-o})&&(l.splice(o,1),l.splice(i,0,a),l.forEach((e,t)=>{e.props.position=t+1}),Da())}function Ha(e){$.Z.set("filters.sort",e.target.value)}function Ea(e){ha.search&&Aa(),$.Z.set("filters.searchScope",e.target.value)}function Ia(e){ha.menuNewActive=e}function Wa(e){const n=f(U.Hv,[va.value?_:o,e],"/");e||n!==(0,E.Qs)().pathname?(0,E.pV)(n):t.history.back()}async function Ta(){const[e,t,n]=I.route.paths,l="_new"===t&&await(0,U.gj)("NewScript",+n),a=l?l.script:+t&&_a().find(e=>e.props.id===+t);if(a)return ha.code=l?l.code:await(0,U.gj)("GetScriptCode",t),void(ha.script=a);if(t&&(0,E.pV)(e,!0),I.canRenderScripts||(I.canRenderScripts=!0,ar()),Oa(),ha.script=null,!w){const e=ga.value,t=e.scrollTop;(0,W.Y3)(()=>{e.scrollTop=t})}}async function Oa(){if(!I.canRenderScripts)return;const{length:e}=ha.sortedScripts;let t=9;const n=(0,H.qj)({limit:t});ha.batchRender=n;const l=g.now();for(;t<e&&n===ha.batchRender;){if(ca&&ha.search)for(let n=0;n<ca&&t<e;t+=1)n+=ha.sortedScripts[t].$cache.show?1:0;else t+=ca||1;n.limit=t,await new u(e=>(0,W.Y3)(e)),!ca&&g.now()-l>=sa&&(ca=2*t),ca&&t<e&&await(0,U.dL)()}}function Ma(e){let t,n=0;const[,l=ha.search.replace(/[.+^*$?|\\()[\]{}]/g,"\\$&"),a="i"]=ha.search.match(/^\/(.+?)\/(\w*)$|$/),o=Jl.searchScope,i="name"===o||"all"===o,s="code"===o||"all"===o;try{t=l&&new RegExp(l,a),e.forEach(({$cache:e})=>{e.show=!l||i&&t.test(e.search)||s&&t.test(e.code),n+=e.show}),ha.searchError=null}catch(e){ha.searchError=e.message}return n}async function Aa(){const e=Ca.value;null!=e&&e.length&&await Va(e),ka()}async function Va(e){const t=await(0,U.gj)("GetScriptCode",e);I.scripts.forEach(({$cache:e,props:{id:n}})=>{n in t&&(e.code=t[n])})}async function Fa(){await(0,R.GW)((0,U.ag)("buttonEmptyRecycleBin"))&&((0,U.gj)("CheckRemove",{force:!0}),I.removedScripts=[])}function La(e){if(Pa(),e&&!ra){ra=(0,j.w)("-width: 76");for(let e=0,t=ra;e<t.length;e++){const n=t[e];n._orig=n.conditionText}}if(ra)for(let t=0,n=ra;t<n.length;t++){const l=n[t],a=l._orig;l.media.mediaText=e?a.replace(/\d+/g,e=>+e+90/devicePixelRatio):a}}function Pa(){const e=Jl.viewTable?ua:da;ha.numColumns=Jl.viewSingleColumn?1:e.findIndex(e=>t.innerWidth<e)+1||e.length+1}function Ya(e){e=Math.min(e,ha.filteredScripts.length-1),(e=Math.max(e,-1))!==ha.focusedIndex&&(ha.focusedIndex=e)}function Za(e,t){return(0,U.gj)("MarkRemoved",{id:e.props.id,removed:t})}function Ba(e){e.config.removed?(0,U.gj)("RemoveScripts",[e.props.id]):Za(e,1)}async function Na(e){try{await Za(e,0)}catch(t){(0,R.GW)(`${t.message||t}\n\n@namespace ${e.meta.namespace}\n@name ${e.meta.name}`,{cancel:!1})}}function qa(e){(0,U.gj)("UpdateScriptInfo",{id:e.props.id,config:{enabled:e.config.enabled?0:1}})}function Ka(e){(0,U.gj)("CheckUpdate",e.props.id)}function Ja(e){if(!e)return;const t=ma.value;t.scroll({top:t.scrollTop+e,behavior:"smooth"})}function Ga(){const e=()=>{var e;Y.$J.setContext("buttonFocus",(null==(e=document.activeElement)?void 0:e.tabIndex)>=0)};d("focus",e,!0);const t=[()=>p("focus",e,!0),...w?[Y.$J.register("tab",()=>{(0,Y.nk)(1)}),Y.$J.register("s-tab",()=>{(0,Y.nk)(-1)})]:[],...ia(()=>{var e;null==(e=pa.value)||e.focus()},[["ctrlcmd-f",Xl],["/",ea,!0]]),...ia(()=>{var e;null==(e=pa.value)||e.blur()},[["enter",Ql]]),...ia(()=>{ha.showHotkeys=!1},[["escape",aa],["q",aa,!0]]),...ia(()=>{let e=ha.focusedIndex;e<0?e=0:e+=ha.numColumns,e<ha.filteredScripts.length&&Ya(e)},[["ctrlcmd-down",Xl],["down",Xl],["j",ea,!0]]),...ia(()=>{const e=ha.focusedIndex-ha.numColumns;e>=0&&Ya(e)},[["ctrlcmd-up",Xl],["up",Xl],["k",ea,!0]]),...ia(()=>{Ya(ha.focusedIndex-1)},[["ctrlcmd-left",Xl],["left",ea],["h",ea,!0]]),...ia(()=>{Ya(ha.focusedIndex+1)},[["ctrlcmd-right",Xl],["right",ea],["l",ea,!0]]),...ia(()=>{Ya(0)},[["ctrlcmd-home",Xl],["g g",ea,!0]]),...ia(()=>{Ya(ha.filteredScripts.length-1)},[["ctrlcmd-end",Xl],["G",ea,!0]]),...ia(()=>{Wa(ya.value.props.id)},[[oa.edit,ta,!0],["enter",la]]),...ia(()=>{Ba(ya.value)},[["delete",ta],[oa.remove,ta,!0]]),...ia(()=>{Ka(ya.value)},[[oa.update,ta,!0]]),...ia(()=>{qa(ya.value)},[[oa.toggle,ta,!0]]),...ia(()=>{Na(ya.value)},[[oa.restore,na,!0]]),...ia(()=>{ha.showHotkeys=!ha.showHotkeys},[["?",ea,!0]])];return()=>t.forEach(e=>{e()})}const Xa={components:{Dropdown:we.Z,Tooltip:be.Z,SettingCheck:ye.Z,Icon:xe.Z,LocaleGroup:Ce.Z,ScriptItem:Ot,Edit:ql},directives:{focus:R.Tu},setup:()=>(Ua(),(0,W.YP)(va,Ua),(0,W.YP)(()=>I.canRenderScripts&&ma.value&&fa.value,e=>Ke(ma.value,ja,e)),(0,W.YP)(()=>ha.search,Aa),(0,W.YP)(()=>[Jl.sort,Jl.showEnabledFirst],ka),screen.availWidth>767&&((0,W.YP)(()=>Jl.viewSingleColumn,Pa),(0,W.YP)(()=>Jl.viewTable,La)),(0,W.YP)(_a,za),(0,W.YP)(()=>I.route.paths[1],Ta),(0,W.YP)(ya,e=>{Y.$J.setContext("selectedScript",e)}),(0,W.YP)(()=>ha.showHotkeys,e=>{Y.$J.setContext("showHotkeys",e)}),(0,W.bv)(()=>{if(I.loading||za(),!da.length){const e=(null==j.$?void 0:j.$.textContent.match(/--columns-(cards|table)\b/))&&getComputedStyle(document.documentElement);if(e)for(let t=0,n=[["cards",da],["table",ua]];t<n.length;t++){const[l,a]=n[t],o=e.getPropertyValue(`--columns-${l}`);o&&a.push(...o.split(",").map(Number).filter(s))}else da.push(1300,1900,2500),ua.push(1600,2500,3400);d("resize",Pa)}return Pa(),Ga()}),{refSearch:pa,refList:ma,scroller:ga,store:I,state:ha,filters:Jl,filterOptions:Kl,currentSortCompare:ba,selectedScript:ya,draggable:wa,scriptHotkeys:oa,showRecycle:va,message:xa,handleStateChange:Ia,handleOrderChange:Ha,handleEditScript:Wa,handleEmptyRecycleBin:Fa,handleInstallFromURL:Ra,handleUpdateAll:$a,handleOnScopeChange:Ea,handleActionRemove:Ba,handleActionRestore:Na,handleActionToggle:qa,handleActionUpdate:Ka,handleSmoothScroll:Ja})},Qa=(0,Wt.Z)(Xa,[["render",(e,t,n,l,a,o)=>{const i=(0,W.up)("Icon"),s=(0,W.up)("Tooltip"),r=(0,W.up)("Dropdown"),c=(0,W.up)("LocaleGroup"),u=(0,W.up)("SettingCheck"),d=(0,W.up)("script-item"),p=(0,W.up)("edit"),m=(0,W.Q2)("focus");return(0,W.wg)(),(0,W.iD)("div",B,[l.store.canRenderScripts?((0,W.wg)(),(0,W.iD)("div",N,[(0,W._)("header",q,[l.showRecycle?((0,W.wg)(),(0,W.iD)("div",{key:1,class:"flex-auto",textContent:(0,T.zw)(e.i18n("headerRecycleBin"))},null,8,te)):((0,W.wg)(),(0,W.iD)("div",K,[(0,W.Wm)(r,{closeAfterClick:!0,class:(0,T.C_)({active:l.state.menuNewActive}),onStateChange:l.handleStateChange},{content:(0,W.w5)(()=>[(0,W._)("a",{class:"dropdown-menu-item",textContent:(0,T.zw)(e.i18n("buttonNew")),tabindex:"0",onClick:t[0]||(t[0]=(0,Z.iM)(e=>l.handleEditScript("_new"),["prevent"]))},null,8,G),(0,W._)("a",{class:"dropdown-menu-item",textContent:(0,T.zw)(e.i18n("installFrom","OpenUserJS")),href:"https://openuserjs.org/",target:"_blank",rel:"noopener noreferrer"},null,8,X),(0,W._)("a",{class:"dropdown-menu-item",textContent:(0,T.zw)(e.i18n("installFrom","GreasyFork")),href:"https://greasyfork.org/scripts",target:"_blank",rel:"noopener noreferrer"},null,8,Q),(0,W._)("a",{class:"dropdown-menu-item",textContent:(0,T.zw)(e.i18n("buttonInstallFromURL")),tabindex:"0",onClick:t[1]||(t[1]=(0,Z.iM)((...e)=>l.handleInstallFromURL&&l.handleInstallFromURL(...e),["prevent"]))},null,8,ee)]),default:(0,W.w5)(()=>[(0,W.Wm)(s,{content:e.i18n("buttonNew"),placement:"bottom",align:"start"},{default:(0,W.w5)(()=>[(0,W._)("a",J,[(0,W.Wm)(i,{name:"plus"})])]),_:1},8,["content"])]),_:1},8,["class","onStateChange"]),(0,W.Wm)(s,{content:e.i18n("buttonUpdateAll"),placement:"bottom",align:"start"},{default:(0,W.w5)(()=>[(0,W._)("a",{class:"btn-ghost",tabindex:"0",onClick:t[2]||(t[2]=(...e)=>l.handleUpdateAll&&l.handleUpdateAll(...e))},[(0,W.Wm)(i,{name:"refresh"})])]),_:1},8,["content"])])),(0,W.Wm)(c,{"i18n-key":"labelFilterSort"},{default:(0,W.w5)(()=>[(0,W._)("select",{value:l.filters.sort,onChange:t[3]||(t[3]=(...e)=>l.handleOrderChange&&l.handleOrderChange(...e)),class:"h-100"},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(l.filterOptions.sort,(e,t)=>((0,W.wg)(),(0,W.iD)("option",{textContent:(0,T.zw)(e.title),key:t,value:t},null,8,le))),128))],40,ne)]),_:1}),(0,W.Wm)(r,{align:"right",class:"filter-sort"},{content:(0,W.w5)(()=>[(0,W.wy)((0,W._)("div",null,[(0,W.Wm)(u,{name:"filters.showEnabledFirst",label:e.i18n("optionShowEnabledFirst")},null,8,["label"])],512),[[Z.F8,l.currentSortCompare]]),(0,W._)("div",null,[(0,W.Wm)(u,{name:"filters.showOrder",label:e.i18n("labelShowOrder")},null,8,["label"])]),(0,W._)("div",oe,[(0,W.Wm)(u,{name:"filters.viewTable",label:e.i18n("labelViewTable")},null,8,["label"]),(0,W.Wm)(u,{name:"filters.viewSingleColumn",label:e.i18n("labelViewSingleColumn")},null,8,["label"])])]),default:(0,W.w5)(()=>[(0,W.Wm)(s,{content:e.i18n("labelSettings"),placement:"bottom"},{default:(0,W.w5)(()=>[(0,W._)("a",ae,[(0,W.Wm)(i,{name:"cog"})])]),_:1},8,["content"])]),_:1}),(0,W._)("form",{class:"filter-search hidden-xs flex",onSubmit:t[7]||(t[7]=(0,Z.iM)(()=>{},["prevent"]))},[(0,W.Wm)(s,{placement:"bottom"},{content:(0,W.w5)(()=>[(0,W._)("pre",{class:"filter-search-tooltip",textContent:(0,T.zw)(l.state.searchError||e.i18n("titleSearchHint"))},null,8,se)]),default:(0,W.w5)(()=>[(0,W._)("label",null,[(0,W.wy)((0,W._)("input",{type:"search",class:(0,T.C_)({"has-error":l.state.searchError}),placeholder:e.i18n("labelSearchScript"),"onUpdate:modelValue":t[4]||(t[4]=e=>l.state.search=e),ref:"refSearch",id:"installed-search"},null,10,ie),[[Z.nr,l.state.search]]),(0,W.Wm)(i,{name:"search"})])]),_:1}),(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>l.filters.searchScope=e),onChange:t[6]||(t[6]=(...e)=>l.handleOnScopeChange&&l.handleOnScopeChange(...e))},[(0,W._)("option",{value:"name",textContent:(0,T.zw)(e.i18n("filterScopeName"))},null,8,re),(0,W._)("option",{value:"code",textContent:(0,T.zw)(e.i18n("filterScopeCode"))},null,8,ce),(0,W._)("option",{value:"all",textContent:(0,T.zw)(e.i18n("filterScopeAll"))},null,8,ue)],544),[[Z.bM,l.filters.searchScope]])],32)]),l.showRecycle?((0,W.wg)(),(0,W.iD)("div",de,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("hintRecycleBin"))},null,8,pe),l.store.removedScripts.length?((0,W.wg)(),(0,W.iD)("a",{key:0,textContent:(0,T.zw)(e.i18n("buttonEmptyRecycleBin")),tabindex:"0",onClick:t[8]||(t[8]=(...e)=>l.handleEmptyRecycleBin&&l.handleEmptyRecycleBin(...e))},null,8,me)):(0,W.kq)("",!0)])):l.message?((0,W.wg)(),(0,W.iD)("div",{key:1,class:"hint mx-1 my-1 flex flex-col",textContent:(0,T.zw)(l.message)},null,8,ge)):(0,W.kq)("",!0),(0,W.wy)(((0,W.wg)(),(0,W.iD)("div",{class:"scripts",ref:"refList",style:(0,T.j5)(`--num-columns:${l.state.numColumns}`),"data-columns":l.state.numColumns,"data-show-order":l.filters.showOrder||null,"data-table":l.filters.viewTable||null},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(l.state.sortedScripts,(e,t)=>(0,W.wy)(((0,W.wg)(),(0,W.j4)(d,{key:e.props.id,focused:l.selectedScript===e,showHotkeys:l.state.showHotkeys,script:e,draggable:l.draggable,visible:t<l.state.batchRender.limit,viewTable:l.filters.viewTable,hotkeys:l.scriptHotkeys,onRemove:l.handleActionRemove,onRestore:l.handleActionRestore,onToggle:l.handleActionToggle,onUpdate:l.handleActionUpdate,onScrollDelta:l.handleSmoothScroll},null,8,["focused","showHotkeys","script","draggable","visible","viewTable","hotkeys","onRemove","onRestore","onToggle","onUpdate","onScrollDelta"])),[[Z.F8,!l.state.search||!1!==e.$cache.show]])),128))],12,he)),[[m,!l.state.script]])])):(0,W.kq)("",!0),((0,W.wg)(),(0,W.j4)(W.lR,{to:"body"},[((0,W.wg)(),(0,W.j4)(W.Ob,{key:l.store.route.hash,max:5},[l.state.script?((0,W.wg)(),(0,W.j4)(p,{key:0,initial:l.state.script,"initial-code":l.state.code,"read-only":!!l.state.script.config.removed,onClose:t[9]||(t[9]=e=>l.handleEditScript())},null,8,["initial","initial-code","read-only"])):(0,W.kq)("",!0)],1024))]))],512)}]]),eo=Qa,to=["data-show-advanced"],no=["textContent"],lo={class:"mb-1c"},ao=["textContent"],oo={class:"ml-2c flex flex-col"},io=["textContent"],so={class:"ml-2c"},ro=["onUpdate:modelValue"],co=["value","textContent"],uo=["onUpdate:modelValue"],po=["value","textContent"],mo=["textContent"],go=["onUpdate:modelValue"],ho=["value","textContent"],vo=["textContent"],fo=["onUpdate:modelValue"],wo=["textContent"],bo={class:"mb-1c"},yo=["textContent"],xo={class:"ml-2c flex flex-col"},Co={class:"ml-2c flex flex-col"},_o={class:"mb-2c"},ko=["textContent"],So=["open"],Uo=["onClick"],zo={class:"mb-1c"},Do=["textContent"],$o=["onUpdate:modelValue"],Ro=["value","textContent"],jo={class:"ml-2c flex flex-col"},Ho=["textContent"],Eo=["onUpdate:modelValue"],Io=["textContent"],Wo=["textContent"],To=(0,W._)("code",null,"page",-1),Oo=["textContent"],Mo={key:0},Ao=(0,W._)("code",null,"page",-1),Vo=["textContent"],Fo=["href"],Lo=["textContent"],Po=["textContent"],Yo=["innerHTML"];var Zo=S(3657),Bo=S(2274);const No=(0,S(4288).HP)(async()=>{await("/public/lib/zip-no-worker.min.js",new u((e,t)=>{const n=document.createElement("script");n.src="/public/lib/zip-no-worker.min.js",n.onload=e,n.onerror=t,document.body.append(n)}));const{zip:e}=t,n=["/public/lib/z-worker.js"];return e.configure({workerScripts:{deflate:n,inflate:n}}),e}),qo=["textContent","disabled"],Ko=["disabled","textContent"],Jo={class:"mt-1"},Go=(0,W._)("br",null,null,-1),Xo={class:"import-report"},Qo=["data-type"],ei=["textContent"],ti=["textContent","colspan"],ni={__name:"vm-import",setup(e){const t=(0,H.qj)([]),n=(0,H.iH)(),l=(0,H.iH)(!1),a=(0,U.ag)("labelImportScriptData"),o=(0,U.ag)("labelImportSettings"),i=(0,H.iH)((0,U.ag)("buttonVacuum"));function r(){const e=document.createElement("input");e.type="file",e.accept=".zip",e.onchange=()=>{var t;return h(null==(t=e.files)?void 0:t[0])},e.click()}async function g(){l.value=!0,i.value=(0,U.ag)("buttonVacuuming");const{fixes:e,errors:t}=await(0,U.gj)("Vacuum"),n=null==t?void 0:t.join("\n");l.value=!1,i.value=(0,U.ag)("buttonVacuumed")+(e?` (${e})`:""),n&&(0,R.GW)((0,U.ag)("msgErrorFetchingResource")+"\n\n"+n,{cancel:!1})}async function h(e){if(!I.importing)try{await(I.importing=v(e))}finally{I.importing=null}}async function v(e){if(!e)return;t.length=0;const n=$.Z.get("importScriptData"),l=$.Z.get("importSettings"),i=await No(),r=new i.ZipReader(new i.BlobReader(e)),d=await r.getEntries().catch(D)||[];if(t.length)return;D("",e.name,"info");const p={},g=d.reduce((e,t)=>{var n;return e+(null==(n=t.filename)?void 0:n.endsWith(".user.js"))},0),h=d.find(e=>{var t;return"violentmonkey"===(null==(t=e.filename)?void 0:t.toLowerCase())}),v=h&&await z(h)||{},w=m.runtime.connect({name:"undoImport"}),b=v.scripts||{},y=v.values||{};var x,C;function _(e){w.onMessage.addListener(function t(){w.onMessage.removeListener(t),e()})}function k(e,t){try{return JSON.parse(e)}catch(e){D(e,t.filename,null)}}function S(e,t){return u.all(d.map(async n=>{const{filename:l}=n;if(null!=l&&l.endsWith(t)){const a=await z(n);return a&&e(n,a,l.slice(0,-t.length))}}))}async function z(e){const t=await e.getData(new i.TextWriter);return e.filename.endsWith(".js")?t:k(t,e)}function D(e,n,l="critical"){t.push({text:e,name:n,type:l})}function j(e=""){const n=c.keys(p).length,l=(0,U.ag)("msgImported",[n===g?n:`${n} / ${g}`]);return t[0].name=l,t[0].text=e,l}function H(e){return(0,U.rY)(e).filter(e=>"string"==typeof e)}await new u(_),await S(async(e,n,l)=>{const{meta:a,settings:o={},options:i}=n;if(!a||!i)return;const s=i.override||{};t[0].text="Tampermonkey",b[l]={config:{enabled:!1!==o.enabled?1:0,shouldUpdate:i.check_for_updates?1:0},custom:{downloadURL:"string"==typeof a.file_url?a.file_url:void 0,noframes:null==s.noframes?void 0:+!!s.noframes,runAt:Vt.qh.test(i.run_at)?i.run_at:void 0,exclude:H(s.use_excludes),include:H(s.use_includes),match:H(s.use_matches),origExclude:!1!==s.merge_excludes,origInclude:!1!==s.merge_includes,origMatch:!1!==s.merge_matches},position:+o.position||void 0,props:{lastModified:+a.modified,lastUpdated:+a.modified}}},".options.json"),await S(async(e,t,n)=>{var l,a,o,i;const{filename:s}=e,r=b[n],c={code:t,...r&&{custom:r.custom,config:{enabled:null!=(l=r.enabled)?l:1,shouldUpdate:null!=(a=r.update)?a:1,...r.config},position:r.position,props:{lastModified:r.lastModified||(null==(o=r.props)?void 0:o.lastModified)||+e.lastModDate,lastUpdated:r.lastUpdated||(null==(i=r.props)?void 0:i.lastUpdated)||+e.lastModDate}}};try{p[n]=(await(0,U.gj)("ParseScript",c)).update.props.uri,j(s)}catch(e){D(e,s,"script")}},".user.js"),n&&(await S(async(e,n,l)=>{t[0].text="Tampermonkey",y[p[l]]=n.data},".storage.json"),(0,U.gj)("SetValueStores",y)),l&&(0,U.gj)("SetOptions",(x=v.settings,C=([e,t])=>"sync"!==e&&{key:e,value:t},c.entries(x||{}).map(C).filter(s))),(0,U.gj)("CheckPosition"),await r.close(),await(0,R.GW)(f(U.Hv,[j(),n&&!(0,U.xb)(y)?"\u2714"+a:"",l?"\u2714"+o:""],"\n"),{cancel:{text:(0,U.ag)("buttonUndo"),class:"has-error"}})?w.disconnect():(w.postMessage(!0),await new u(_))}function w(e){let t;const n=t=>e.classList.toggle("drop-allowed",t),l=()=>n(!1),a=()=>{clearTimeout(t),t=setTimeout(l,250)},o=e=>{clearTimeout(t);const l=e.dataTransfer.types.includes("Files");l&&e.preventDefault(),n(l)},i=async e=>{e.preventDefault(),n(!1);const t=e.dataTransfer.files[0];await(0,R.GW)((0,U.ag)("buttonImportData"))&&await h(t)};return()=>{const e=I.route.hash===x?d:p;e("dragend",l),e("dragleave",a),e("dragover",o),e("drop",i)}}return(0,W.bv)(()=>{const e=w(n.value);d("hashchange",e),e()}),(e,s)=>((0,W.wg)(),(0,W.iD)("div",null,[(0,W._)("button",{textContent:(0,T.zw)((0,H.SU)(U.ag)("buttonImportData")),onClick:r,ref_key:"buttonImport",ref:n,disabled:(0,H.SU)(I).importing},null,8,qo),(0,W.Wm)((0,H.SU)(be.Z),{content:(0,H.SU)(U.ag)("hintVacuum")},{default:(0,W.w5)(()=>[(0,W._)("button",{onClick:g,disabled:l.value,textContent:(0,T.zw)(i.value)},null,8,Ko)]),_:1},8,["content"]),(0,W._)("div",Jo,[(0,W.Wm)((0,H.SU)(ye.Z),{name:"importScriptData",label:(0,H.SU)(a)},null,8,["label"]),Go,(0,W.Wm)((0,H.SU)(ye.Z),{name:"importSettings",label:(0,H.SU)(o)},null,8,["label"])]),(0,W._)("table",Xo,[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(t,({type:e,name:t,text:n},l)=>((0,W.wg)(),(0,W.iD)("tr",{key:l,"data-type":e},[t?((0,W.wg)(),(0,W.iD)("td",{key:0,textContent:(0,T.zw)(t)},null,8,ei)):(0,W.kq)("",!0),(0,W._)("td",{textContent:(0,T.zw)(n),colspan:t?null:2},null,8,ti)],8,Qo))),128))])]))}},li=ni;var ai=S(950),oi=S(4460),ii=S(3557);const si=(0,U.ag)("msgDateFormatInfo",c.keys(oi.q).join(", ")),ri={__name:"vm-date-info",setup:e=>(e,t)=>((0,W.wg)(),(0,W.j4)((0,H.SU)(be.Z),{content:(0,H.SU)(si),placement:"left",style:{"vertical-align":"middle"}},{default:(0,W.w5)(()=>[(0,W._)("a",{href:"https://momentjs.com/docs/#/displaying/format/",target:"_blank"},[(0,W.Wm)((0,H.SU)(xe.Z),{name:"info"})])]),_:1},8,["content"]))},ci={class:"export"},ui={class:"flex flex-wrap center-items mr-1c"},di=["textContent","disabled"],pi=["textContent"],mi={class:"mt-1"},gi={class:"modal-content"},hi=["download","href"],vi=(0,W._)("br",null,null,-1),fi=(0,W._)("strong",null,"scripts.zip",-1),wi={__name:"vm-export",setup(e){let t;const n=(0,H.iH)(),l=(0,H.iH)(!1),a=(0,H.iH)(w&&{}),o=(0,W.Fl)(()=>{const e=n.value;return e&&`${(0,oi.p)(e.text.trim()||e.defaultValue)}.zip`});async function i(){try{l.value=!0,w&&!t&&(t=await(0,U.gj)("UA")),s(await c())}finally{l.value=!1}}function s(e){const n=w&&parseFloat(t.version),l=o.value;if(n&&("win"===t.os?n<56:"mac"===t.os?n<61:n<63)){const t=new FileReader;t.onload=()=>{a.value={name:l,url:t.result}},t.readAsDataURL(e)}else(0,ii.l)(e,l)}function r(e){return e.replace(/[\\/:*?"<>|]/g,"-")}async function c(){const e=$.Z.get("exportValues"),t=await(0,U.gj)("ExportZip",{values:e}),n={},l={scripts:{},settings:$.Z.get()};delete l.settings.sync,e&&(l.values={});const a=((0,fe._M)(t,"items")||[]).map(({script:a,code:o})=>{let i=r((0,U.pV)(a));n[i]?(n[i]+=1,i=`${i}_${n[i]}`):n[i]=1;const{lastModified:s,lastUpdated:c}=a.props,u={custom:a.custom,config:a.config,position:a.props.position,lastModified:s,lastUpdated:c};if(e){const e=t.values[a.props.id];e&&(l.values[a.props.uri]=e)}return l.scripts[i]=u,{name:`${i}.user.js`,content:o,lastModDate:new Date(c||s)}});a.push({name:"violentmonkey",content:JSON.stringify(l,null,2)});const o=await No(),i=new o.BlobWriter("application/zip"),s=new o.ZipWriter(i,{bufferedWrite:!0,keepOrder:!1});return await u.all(a.map(e=>s.add(e.name,new o.TextReader(e.content),{lastModDate:e.lastModDate}))),await s.close()}return(e,t)=>((0,W.wg)(),(0,W.iD)("div",ci,[(0,W._)("div",ui,[(0,W._)("button",{textContent:(0,T.zw)(e.i18n("buttonExportData")),onClick:i,disabled:l.value},null,8,di),(0,W.Wm)((0,H.SU)(Bo.Z),{name:"exportNameTemplate",ref_key:"tpl",ref:n,"has-reset":"","has-save":!1,rows:1,class:"tpl flex flex-1 center-items ml-1c"},null,512),(0,W.Wm)((0,H.SU)(ri)),(0,W._)("span",{hidden:"",textContent:(0,T.zw)(o.value)},null,8,pi)]),(0,W._)("div",mi,[(0,W.Wm)((0,H.SU)(ye.Z),{name:"exportValues",label:e.i18n("labelExportScriptData")},null,8,["label"])]),a.value?((0,W.wg)(),(0,W.j4)((0,H.SU)(ai.Z),{key:0,transition:"in-out",show:!!a.value.url,onClose:t[0]||(t[0]=e=>a.value={})},{default:(0,W.w5)(()=>[(0,W._)("div",gi,[(0,W._)("a",{download:a.value.name,href:a.value.url},[(0,W.Uk)(" Right click and save as"),vi,fi],8,hi)])]),_:1},8,["show"])):(0,W.kq)("",!0)]))}},bi=wi,yi={class:"mb-1c"},xi=["textContent"],Ci={key:0,class:"flex flex-wrap center-items"},_i=["textContent"],ki=["value"],Si=["textContent","value"],Ui=["textContent","disabled"],zi=["disabled"],Di=["textContent"],$i={key:1,class:"mt-1c"},Ri={class:"sync-server-url"},ji=["textContent"],Hi=["disabled"],Ei={class:"mr-2c"},Ii=["textContent"],Wi=["disabled"],Ti={class:"inline-block"},Oi=["textContent"],Mi=["disabled"],Ai=["disabled"],Vi=["textContent"],Fi=["textContent","disabled"],Li={key:2},Pi="sync.current",Yi={current:""};(0,ve.Z)(Pi,e=>{Yi.current=e||""});const Zi={components:{SettingCheck:ye.Z,Icon:xe.Z,Tooltip:be.Z},data:()=>({syncConfig:Yi,store:I}),computed:{syncServices(){const e=this.store.sync;return e&&e.length?[{displayName:this.i18n("labelSyncDisabled"),name:"",properties:{}},...e]:null},service(){if(this.syncServices){const e=this.syncConfig.current||"";let t=this.syncServices.find(t=>t.name===e);return t||(console.warn("Invalid current service:",e),t=this.syncServices[0]),t}return null},state(){const{service:e}=this;if(e){const t=["idle","error"].includes(e.syncState)&&["no-auth","unauthorized","error","authorized"].includes(e.authState),n=t&&"authorized"===e.authState;return{message:this.getMessage(),label:this.getLabel(),canAuthorize:t,canSync:n,authType:e.properties.authType,userConfig:e.userConfig||{}}}return null}},methods:{onSaveUserConfig(){(0,U.gj)("SyncSetConfig",this.state.userConfig)},onSyncChange(e){const{value:t}=e.target;$.Z.set(Pi,t)},onAuthorize(){const{service:e}=this;["authorized"].includes(e.authState)?(0,U.gj)("SyncRevoke"):["no-auth","unauthorized","error"].includes(e.authState)&&(0,U.gj)("SyncAuthorize")},onSync(){(0,U.gj)("SyncStart")},getMessage(){const{service:e}=this;if("initializing"===e.authState)return this.i18n("msgSyncInit");if("no-auth"===e.authState)return this.i18n("msgSyncNoAuthYet");if("error"===e.authState)return this.i18n("msgSyncInitError");if("unauthorized"===e.authState)return this.i18n("msgSyncInitError");if("error"===e.syncState)return this.i18n("msgSyncError");if("ready"===e.syncState)return this.i18n("msgSyncReady");if("syncing"===e.syncState){let t="";return e.progress&&e.progress.total&&(t=` (${e.progress.finished}/${e.progress.total})`),this.i18n("msgSyncing")+t}if(e.lastSync){const t=new Date(e.lastSync).toLocaleString();return this.i18n("lastSync",t)}},getLabel(){const{service:e}=this;return"authorizing"===e.authState?this.i18n("labelSyncAuthorizing"):"authorized"===e.authState?this.i18n("labelSyncRevoke"):this.i18n("labelSyncAuthorize")}}},Bi=(0,Wt.Z)(Zi,[["render",(e,t,n,l,a,o)=>{var i,s;const r=(0,W.up)("icon"),c=(0,W.up)("tooltip"),u=(0,W.up)("setting-check");return(0,W.wg)(),(0,W.iD)("section",yi,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("labelSync"))},null,8,xi),o.state?((0,W.wg)(),(0,W.iD)("div",Ci,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelSyncService"))},null,8,_i),(0,W._)("select",{class:"mx-1",value:a.syncConfig.current,onChange:t[0]||(t[0]=(...e)=>o.onSyncChange&&o.onSyncChange(...e))},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(o.syncServices,e=>((0,W.wg)(),(0,W.iD)("option",{key:e.name,textContent:(0,T.zw)(e.displayName),value:e.name},null,8,Si))),128))],40,ki),o.service.name&&"oauth"===o.state.authType?((0,W.wg)(),(0,W.iD)("button",{key:0,textContent:(0,T.zw)(o.state.label),disabled:!o.state.canAuthorize,onClick:t[1]||(t[1]=(...e)=>o.onAuthorize&&o.onAuthorize(...e))},null,8,Ui)):(0,W.kq)("",!0),o.service.name?((0,W.wg)(),(0,W.j4)(c,{key:1,content:e.i18n("labelSync"),class:"stretch-self flex mr-1"},{default:(0,W.w5)(()=>[(0,W._)("button",{disabled:!o.state.canSync,onClick:t[2]||(t[2]=(...e)=>o.onSync&&o.onSync(...e)),class:"flex center-items"},[(0,W.Wm)(r,{name:"refresh"})],8,zi)]),_:1},8,["content"])):(0,W.kq)("",!0),o.state?((0,W.wg)(),(0,W.iD)("p",{key:2,textContent:(0,T.zw)(o.state.message)},null,8,Di)):(0,W.kq)("",!0)])):(0,W.kq)("",!0),"password"===(null==(i=o.state)?void 0:i.authType)?((0,W.wg)(),(0,W.iD)("fieldset",$i,[(0,W._)("label",Ri,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelSyncServerUrl"))},null,8,ji),(0,W.wy)((0,W._)("input",{type:"url","onUpdate:modelValue":t[3]||(t[3]=e=>o.state.userConfig.serverUrl=e),disabled:!o.state.canAuthorize},null,8,Hi),[[Z.nr,o.state.userConfig.serverUrl]])]),(0,W._)("div",Ei,[(0,W._)("label",null,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelSyncUsername"))},null,8,Ii),(0,W.wy)((0,W._)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>o.state.userConfig.username=e),disabled:!o.state.canAuthorize||o.state.userConfig.anonymous},null,8,Wi),[[Z.nr,o.state.userConfig.username]])]),(0,W._)("label",Ti,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelSyncPassword"))},null,8,Oi),(0,W.wy)((0,W._)("input",{type:"password","onUpdate:modelValue":t[5]||(t[5]=e=>o.state.userConfig.password=e),disabled:!o.state.canAuthorize||o.state.userConfig.anonymous},null,8,Mi),[[Z.nr,o.state.userConfig.password]])]),(0,W._)("label",null,[(0,W.wy)((0,W._)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>o.state.userConfig.anonymous=e),disabled:!o.state.canAuthorize},null,8,Ai),[[Z.e8,o.state.userConfig.anonymous]]),(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelSyncAnonymous"))},null,8,Vi)])]),(0,W._)("div",null,[(0,W._)("button",{textContent:(0,T.zw)(e.i18n("buttonSave")),onClick:t[7]||(t[7]=(0,Z.iM)((...e)=>o.onSaveUserConfig&&o.onSaveUserConfig(...e),["prevent"])),disabled:!o.state.canAuthorize},null,8,Fi)])])):(0,W.kq)("",!0),null!=(s=o.service)&&s.name?((0,W.wg)(),(0,W.iD)("div",Li,[(0,W.Wm)(u,{name:"syncScriptStatus",label:e.i18n("labelSyncScriptStatus")},null,8,["label"])])):(0,W.kq)("",!0)])}]]),Ni=["textContent"],qi={class:"mr-1c flex center-items"},Ki=["textContent"],Ji=["disabled","title"],Gi=["value","textContent"],Xi=["textContent"],Qi=["textContent"],es=["href"],ts=["textContent"],ns=["innerHTML"],ls=["textContent"],as=["textContent"],os="editorTheme",is="editorThemeName",ss=["3024-day","3024-night","abbott","abcdef","ambiance-mobile","ambiance","ayu-dark","ayu-mirage","base16-dark","base16-light","bespin","blackboard","cobalt","colorforth","darcula","dracula","duotone-dark","duotone-light","eclipse","elegant","erlang-dark","gruvbox-dark","hopscotch","icecoder","idea","isotope","juejin","lesser-dark","liquibyte","lucario","material-darker","material-ocean","material-palenight","material","mbo","mdn-like","midnight","monokai","moxer","neat","neo","night","nord","oceanic-next","panda-syntax","paraiso-dark","paraiso-light","pastel-on-dark","railscasts","rubyblue","seti","shadowfox","solarized","ssms","the-matrix","tomorrow-night-bright","tomorrow-night-eighties","ttcn","twilight","vibrant-ink","xq-dark","xq-light","yeti","yonce","zenburn"],rs="codemirror/CodeMirror",cs="master",us="theme",ds=`https://github.com/${rs}/tree/${cs}/${us}`,ps="default",ms=e=>e?e.split("\n",21).map((e,t)=>(20===t?"...":e.length>100&&`${e.slice(0,100)}...`)||e).join("\n"):null,gs={data:()=>({hint:null,busy:!1,error:null,css:null,theme:null,themes:ss,DEFAULT:ps,ghURL:ds}),components:{SettingText:Bo.Z},beforeUnmount(){this.revokers.forEach(e=>e()),this.revokers=null},async mounted(){this.revokers||(this.css=ms($.Z.get(os)),this.revokers=[(0,ve.Z)(is,e=>{this.theme=null!=e?e:ps})],await $.Z.ready,this.$watch("theme",async e=>{const t=e&&e!==ps&&`https://raw.githubusercontent.com/${rs}/${cs}/${us}/${e}.css`,n=t&&await this.fetch(t);$.Z.set(is,!t||n?e:ps),$.Z.set(os,n||""),this.css=ms(n)}))},methods:{async fetch(e,t="text"){const n=document.activeElement;this.busy=!0;try{const n=await(await fetch(e))[t]();return this.error=null,n}catch(e){this.error=e.message||e.code||`${e}`}finally{this.busy=!1,this.$nextTick(()=>null==n?void 0:n.focus())}},toggleBoolean(e){const t=e.target,{selectionStart:n,selectionEnd:l,value:a}=t,o=l&&{false:"true",true:"false"}[a.slice(n,l)];o&&!document.execCommand("insertText",!1,o)&&(t.value=a.slice(0,n)+o+a.slice(l),t.setSelectionRange(n+o.length,n+o.length),t.dispatchEvent(new Event("input")),t.onblur=()=>t.dispatchEvent(new Event("change")))},async toggleStateHint(){if(this.hint)return void(this.hint=null);const e=["mode","value","configureMouse","lineNumberFormatter","specialCharPlaceholder"],n={};c.entries({...(await u.resolve().then(S.t.bind(S,4631,23))).default.defaults,...(await u.resolve().then(S.bind(S,2327))).default.data().cmDefaults,...$.Z.get("editor")}).sort(([e],[t])=>e<t?-1:e>t).filter(([t,n])=>!e.includes(t)&&!i(n)).forEach(([e,t])=>{n[e]=t}),this.hint=JSON.stringify(n,null,"  "),setTimeout(()=>{this.$el.getBoundingClientRect().bottom>t.innerHeight&&this.$el.scrollIntoView({behavior:"smooth"})})}}},hs=(0,Wt.Z)(gs,[["render",(e,t,n,l,a,o)=>{const i=(0,W.up)("setting-text");return(0,W.wg)(),(0,W.iD)("section",null,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("labelEditor"))},null,8,Ni),(0,W._)("div",qi,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelTheme"))},null,8,Ki),(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.theme=e),disabled:a.busy,title:a.css},[(0,W._)("option",{value:a.DEFAULT,textContent:(0,T.zw)(e.i18n("labelRunAtDefault"))},null,8,Gi),(0,W._)("option",{value:"",textContent:(0,T.zw)(e.i18n("labelBadgeNone"))},null,8,Xi),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.themes,e=>((0,W.wg)(),(0,W.iD)("option",{key:e,textContent:(0,T.zw)(e)},null,8,Qi))),128))],8,Ji),[[Z.bM,a.theme]]),(0,W._)("a",{href:a.ghURL,target:"_blank"},"\u2197",8,es),(0,W._)("p",{textContent:(0,T.zw)(a.error)},null,8,ts)]),(0,W._)("p",{innerHTML:e.i18n("descEditorOptions"),class:"my-1"},null,8,ns),(0,W.Wm)(i,{name:"editor",json:"","has-reset":"",onDblclick:o.toggleBoolean},{default:(0,W.w5)(()=>[(0,W._)("button",{textContent:(0,T.zw)(e.i18n("buttonShowEditorState")),onClick:t[1]||(t[1]=(...e)=>o.toggleStateHint&&o.toggleStateHint(...e))},null,8,ls)]),_:1},8,["onDblclick"]),(0,W._)("pre",{textContent:(0,T.zw)(a.hint),class:"monospace-font dim-hint"},null,8,as)])}]]),vs=["textContent"],fs=["textContent"],ws={class:"flex flex-wrap"},bs={key:0,class:"text-red"},ys=["textContent"],xs={components:{SettingText:Bo.Z},data:()=>({errors:null}),async mounted(){this.errors=await(0,U.gj)("Storage",["base","getOne",Vt.BZ])}},Cs=(0,Wt.Z)(xs,[["render",(e,t,n,l,a,o)=>{const i=(0,W.up)("setting-text");return(0,W.wg)(),(0,W.iD)("section",null,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("labelBlacklist"))},null,8,vs),(0,W._)("p",null,[(0,W.Uk)((0,T.zw)(e.i18n("descBlacklist"))+" ",1),(0,W._)("a",{href:"https://violentmonkey.github.io/posts/smart-rules-for-blacklist/#blacklist-patterns",target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(e.i18n("learnBlacklist"))},null,8,fs)]),(0,W._)("div",ws,[(0,W.Wm)(i,{name:"blacklist",class:"flex-1",onBgError:t[0]||(t[0]=e=>a.errors=e)}),a.errors?((0,W.wg)(),(0,W.iD)("ol",bs,[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.errors,e=>((0,W.wg)(),(0,W.iD)("li",{key:e,textContent:(0,T.zw)(e)},null,8,ys))),128))])):(0,W.kq)("",!0)])])}]]),_s={badgeColor:(0,U.ag)("titleBadgeColor"),badgeColorBlocked:(0,U.ag)("titleBadgeColorBlocked")},ks=c.keys(_s),Ss={enum:_s,normalize:(e,t)=>/^#[0-9a-f]{6}$/i.test(e)?e:Zo.Z[t]},Us={autoUpdate:{normalize:e=>Math.max(0,Math.min(365,+e||0))},defaultInjectInto:{enum:Vt.Wg},showAdvanced:{normalize:e=>e},showBadge:{enum:{"":(0,U.ag)("labelBadgeNone"),unique:(0,U.ag)("labelBadgeUnique"),total:(0,U.ag)("labelBadgeTotal")}},"filtersPopup.hideDisabled":{enum:{"":(0,U.ag)("optionPopupShowDisabled"),group:(0,U.ag)("optionPopupGroupDisabled"),hide:(0,U.ag)("optionPopupHideDisabled")}},"filtersPopup.sort":{enum:{exec:(0,U.ag)("filterExecutionOrder"),alpha:(0,U.ag)("filterAlphabeticalOrder")}},uiTheme:{enum:{"":(0,U.ag)("optionUiThemeAuto"),dark:(0,U.ag)("optionUiThemeDark"),light:(0,U.ag)("optionUiThemeLight")}},xhrInject:{normalize:e=>e},...f(fe.Xw,_s,()=>Ss)},zs=(e,t)=>v(Us[t].enum,e)?e:c.keys(Us[t].enum)[0],Ds=(e,t)=>(0,U.Ds)((n,l)=>{(n=t(n,e))!==(l=t(l,e))&&$.Z.set(e,n)},50),$s=(0,H.qj)({}),Rs={components:{VmImport:li,VmExport:bi,VmSync:Bi,VmEditor:hs,VmBlacklist:Cs,VmDateInfo:ri,SettingCheck:ye.Z,SettingText:Bo.Z,LocaleGroup:Ce.Z,Tooltip:be.Z},data:()=>({expose:null,items:Us,settings:$s}),computed:{editorWindowHint(){var e;return null!=(e=m.windows)&&e.onBoundsChanged?null:this.i18n("optionEditorWindowHint")},isCustomBadgeColor:()=>ks.some(e=>$s[e]!==Zo.Z[e])},methods:{ctrlS(){document.activeElement.dispatchEvent(new Event("ctrl-s"))},onResetBadgeColors(){ks.forEach(e=>{$s[e]=Zo.Z[e]})}},activated(){(0,R.wO)(this.$el),this.revokers=[Y.$J.register("ctrlcmd-s",this.ctrlS,{condition:"inputFocus"})],f(fe.LI,Us,([e,{normalize:t=zs}])=>{this.revokers.push((0,ve.Z)(e,n=>{$s[e]=t(n,e)})),this.$watch(()=>$s[e],Ds(e,t))}),this.expose=c.keys($.Z.get(n)).map(e=>[e,decodeURIComponent(e)])},deactivated(){this.revokers.forEach(e=>{e()})}},js=(0,Wt.Z)(Rs,[["render",(e,t,n,l,a,o)=>{var i;const s=(0,W.up)("setting-check"),r=(0,W.up)("tooltip"),c=(0,W.up)("locale-group"),u=(0,W.up)("vm-import"),d=(0,W.up)("vm-export"),p=(0,W.up)("vm-sync"),m=(0,W.up)("vm-editor"),g=(0,W.up)("vm-date-info"),h=(0,W.up)("setting-text"),v=(0,W.up)("vm-blacklist");return(0,W.wg)(),(0,W.iD)("div",{class:"tab-settings","data-show-advanced":a.settings.showAdvanced},[(0,W._)("h1",{textContent:(0,T.zw)(e.i18n("labelSettings"))},null,8,no),(0,W._)("section",lo,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("optionPopup"))},null,8,ao),(0,W._)("div",null,[(0,W.Wm)(s,{name:"autoReload",label:e.i18n("labelAutoReloadCurrentTab")},null,8,["label"])]),(0,W._)("div",oo,[(0,W.Wm)(s,{name:"editorWindow",class:"mr-2",ref:"EW"},{default:(0,W.w5)(()=>[(0,W.Wm)(r,{content:o.editorWindowHint,disabled:!o.editorWindowHint},{default:(0,W.w5)(()=>[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("optionEditorWindow"))},null,8,io)]),_:1},8,["content","disabled"])]),_:1},512),(0,W.wy)((0,W.Wm)(s,{name:"editorWindowSimple",label:e.i18n("optionEditorWindowSimple")},null,8,["label"]),[[Z.F8,null==(i=e.$refs.EW)?void 0:i.value]])]),(0,W._)("div",so,[(0,W._)("label",null,[(0,W.Wm)(c,{"i18n-key":"labelPopupSort"},{default:(0,W.w5)(()=>[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(["filtersPopup.sort"],e=>(0,W.wy)(((0,W.wg)(),(0,W.iD)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.items[e].enum,(t,n)=>((0,W.wg)(),(0,W.iD)("option",{key:`${e}:${n}`,value:n,textContent:(0,T.zw)(t)},null,8,co))),128))],8,ro)),[[Z.bM,a.settings[e]]])),128))]),_:1})]),(0,W.wy)((0,W.Wm)(s,{name:"filtersPopup.groupRunAt",label:e.i18n("optionPopupGroupRunAt")},null,8,["label"]),[[Z.F8,"exec"===a.settings["filtersPopup.sort"]]]),(0,W._)("label",null,[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(["filtersPopup.hideDisabled"],e=>(0,W.wy)(((0,W.wg)(),(0,W.iD)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.items[e].enum,(t,n)=>((0,W.wg)(),(0,W.iD)("option",{key:`${e}:${n}`,value:n,textContent:(0,T.zw)(t)},null,8,po))),128))],8,uo)),[[Z.bM,a.settings[e]]])),128))]),(0,W.wy)((0,W.Wm)(s,{name:"filtersPopup.enabledFirst",label:e.i18n("optionPopupEnabledFirst")},null,8,["label"]),[[Z.F8,!a.settings["filtersPopup.hideDisabled"]]])]),(0,W._)("div",null,[(0,W._)("label",null,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelBadge"))},null,8,mo),((0,W.wg)(),(0,W.iD)(W.HY,null,(0,W.Ko)(["showBadge"],e=>(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.items[e].enum,(t,n)=>((0,W.wg)(),(0,W.iD)("option",{key:`${e}:${n}`,value:n,textContent:(0,T.zw)(t)},null,8,ho))),128))],8,go),[[Z.bM,a.settings[e]]])),64))])]),(0,W._)("div",null,[(0,W._)("label",null,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelBadgeColors"))},null,8,vo),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.items.badgeColor.enum,(e,t)=>((0,W.wg)(),(0,W.j4)(r,{key:`bc:${t}`,content:e},{default:(0,W.w5)(()=>[(0,W.wy)((0,W._)("input",{type:"color","onUpdate:modelValue":e=>a.settings[t]=e},null,8,fo),[[Z.nr,a.settings[t]]])]),_:2},1032,["content"]))),128)),(0,W.wy)((0,W._)("button",{textContent:(0,T.zw)(e.i18n("buttonReset")),class:"ml-1",onClick:t[0]||(t[0]=(...e)=>o.onResetBadgeColors&&o.onResetBadgeColors(...e))},null,8,wo),[[Z.F8,o.isCustomBadgeColor]])])])]),(0,W._)("section",bo,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("optionUpdate"))},null,8,yo),(0,W._)("div",xo,[(0,W._)("label",null,[(0,W.Wm)(c,{"i18n-key":"labelAutoUpdate"},{default:(0,W.w5)(()=>[(0,W.wy)((0,W._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.settings.autoUpdate=e),type:"number",min:"0",max:"365",step:"1/"},null,512),[[Z.nr,a.settings.autoUpdate]])]),_:1})]),(0,W.Wm)(s,{name:"updateEnabledScriptsOnly",label:e.i18n("labelEnabledScriptsOnly")},null,8,["label"])]),(0,W._)("div",Co,[(0,W.Wm)(s,{name:"notifyUpdates",label:e.i18n("labelNotifyUpdates")},null,8,["label"]),(0,W.Wm)(s,{name:"notifyUpdatesGlobal",label:e.i18n("labelNotifyUpdatesGlobal"),class:"ml-2"},null,8,["label"])])]),(0,W._)("section",_o,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("labelBackup"))},null,8,ko),(0,W.Wm)(u),(0,W.Wm)(d)]),(0,W.Wm)(p),((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)({showAdvanced:a.settings},(t,n)=>((0,W.wg)(),(0,W.iD)("details",{key:n,open:t[n]},[(0,W._)("summary",{onClick:(0,Z.iM)(e=>t[n]=!t[n],["prevent"])},[((0,W.wg)(),(0,W.j4)((0,W.LL)(t[n]?"h1":"h3"),{textContent:(0,T.zw)(e.i18n("labelAdvanced")),class:"inline-block"},null,8,["textContent"]))],8,Uo),(0,W._)("section",zo,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("labelGeneral"))},null,8,Do),(0,W._)("div",null,[(0,W._)("label",null,[(0,W.Wm)(c,{"i18n-key":"optionUiTheme"},{default:(0,W.w5)(()=>[((0,W.wg)(),(0,W.iD)(W.HY,null,(0,W.Ko)(["uiTheme"],e=>(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.items[e].enum,(e,t)=>((0,W.wg)(),(0,W.iD)("option",{key:t,value:t,textContent:(0,T.zw)(e)},null,8,Ro))),128))],8,$o),[[Z.bM,a.settings[e]]])),64))]),_:1})])]),(0,W._)("div",jo,[(0,W._)("label",null,[(0,W._)("span",{textContent:(0,T.zw)(e.i18n("labelInjectionMode"))},null,8,Ho),((0,W.wg)(),(0,W.iD)(W.HY,null,(0,W.Ko)(["defaultInjectInto"],e=>(0,W.wy)((0,W._)("select",{"onUpdate:modelValue":t=>a.settings[e]=t,key:e},[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.items[e].enum,(e,t)=>((0,W.wg)(),(0,W.iD)("option",{key:t,textContent:(0,T.zw)(t)},null,8,Io))),128))],8,Eo),[[Z.bM,a.settings[e]]])),64)),(0,W._)("a",{class:"ml-1",href:"https://violentmonkey.github.io/posts/inject-into-context/",target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(e.i18n("learnInjectionMode"))},null,8,Wo)]),(0,W.Wm)(r,{content:e.i18n("labelXhrInjectHint")},{default:(0,W.w5)(()=>[(0,W.Wm)(s,{name:"xhrInject"},{default:(0,W.w5)(()=>[(0,W.Wm)(c,{"i18n-key":"labelXhrInject"},{default:(0,W.w5)(()=>[To]),_:1}),(0,W.Uk)(),(0,W._)("ruby",{textContent:(0,T.zw)(e.i18n("labelXhrInjectNote"))},null,8,Oo)]),_:1})]),_:1},8,["content"]),a.settings.xhrInject?(0,W.kq)("",!0):((0,W.wg)(),(0,W.iD)("label",Mo,[(0,W.Wm)(s,{name:"ffInject"}),(0,W.Wm)(r,{content:e.i18n("labelFastFirefoxInjectHint")},{default:(0,W.w5)(()=>[(0,W.Wm)(c,{"i18n-key":"labelFastFirefoxInject"},{default:(0,W.w5)(()=>[Ao]),_:1})]),_:1},8,["content"])]))]),(0,W._)("div",null,[(0,W.Wm)(c,{"i18n-key":"labelExposeStatus",class:"flex flex-col"},{default:(0,W.w5)(()=>[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(a.expose,([e,t])=>((0,W.wg)(),(0,W.j4)(s,{key:t,name:`expose.${e}`,class:"ml-2 mr-1c valign-tb"},{default:(0,W.w5)(()=>[(0,W._)("span",{textContent:(0,T.zw)(t)},null,8,Vo),(0,W._)("a",{href:`https://${t}`,target:"_blank",rel:"noopener noreferrer"},"\u2197",8,Fo)]),_:2},1032,["name"]))),128))]),_:2},1024)]),(0,W.Wm)(s,{name:"helpForLocalFile",label:e.i18n("helpForLocalFile")},null,8,["label"])]),(0,W.Wm)(m),(0,W._)("section",null,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("labelScriptTemplate"))},null,8,Lo),(0,W._)("p",null,[((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(e.i18n("descScriptTemplate").split(/<(\S+?)>/),(e,t)=>((0,W.wg)(),(0,W.j4)((0,W.LL)(t%2?"code":"span"),{textContent:(0,T.zw)(e),key:t},null,8,["textContent"]))),128)),(0,W.Uk)(),(0,W.Wm)(g)]),(0,W.Wm)(h,{name:"scriptTemplate","has-reset":""})]),(0,W.Wm)(v),(0,W._)("section",null,[(0,W._)("h3",{textContent:(0,T.zw)(e.i18n("labelCustomCSS"))},null,8,Po),(0,W._)("p",{innerHTML:e.i18n("descCustomCSS")},null,8,Yo),(0,W.Wm)(h,{name:"customCSS"})])],8,So))),128))],8,to)}]]),Hs={class:"tab-about mb-2c"},Es={class:"mt-0 mr-1c"},Is=["textContent"],Ws=["textContent"],Ts=["textContent"],Os=["textContent"],Ms=["textContent"],As=["textContent"],Vs=["textContent"],Fs=["textContent"],Ls=["textContent"],Ps=["textContent"],Ys=["textContent"],Zs={__name:"tab-about",setup(e){const t=y.name,n=browser.i18n.getUILanguage();return(e,l)=>((0,W.wg)(),(0,W.iD)("div",Hs,[(0,W._)("h1",Es,[(0,W._)("span",{textContent:(0,T.zw)((0,H.SU)(t))},null,8,Is),(0,W._)("small",{textContent:(0,T.zw)(`v${(0,H.SU)("2.17.0")}`)},null,8,Ws)]),(0,W._)("p",{textContent:(0,T.zw)(e.i18n("extDescription"))},null,8,Ts),(0,W._)("div",null,[(0,W._)("label",{textContent:(0,T.zw)(e.i18n("labelRelated"))},null,8,Os),(0,W._)("ul",null,[(0,W._)("li",null,[(0,W._)("a",{href:"https://violentmonkey.github.io",target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(e.i18n("labelHomepage"))},null,8,Ms)]),(0,W._)("li",null,[(0,W._)("a",{href:"https://github.com/violentmonkey/violentmonkey/issues",target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(e.i18n("labelFeedback"))},null,8,As)]),(0,W._)("li",null,[(0,W._)("a",{href:"https://github.com/violentmonkey/violentmonkey/graphs/contributors",target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(e.i18n("labelContributors"))},null,8,Vs)]),(0,W._)("li",null,[(0,W._)("a",{href:"https://violentmonkey.github.io/privacy/",target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(e.i18n("labelPrivacyPolicy"))},null,8,Fs)])])]),(0,W._)("div",null,[(0,W._)("label",{textContent:(0,T.zw)(e.i18n("labelCurrentLang"))},null,8,Ls),(0,W._)("span",{class:"current",textContent:(0,T.zw)((0,H.SU)(n))},null,8,Ps),(0,W.Uk)(" | "),(0,W._)("a",{href:"https://violentmonkey.github.io/localization/",target:"_blank",rel:"noopener noreferrer",textContent:(0,T.zw)(e.i18n("labelHelpTranslate"))},null,8,Ys)])]))}},Bs=[{name:o,comp:eo,label:(0,U.ag)("sideMenuInstalled")},{name:x,comp:js,label:(0,U.ag)("sideMenuSettings")},{name:C,comp:Zs,label:(0,U.ag)("sideMenuAbout")},{name:_,comp:eo,label:(0,U.ag)("buttonRecycleBin")}],Ns=(0,U.ag)("extName"),qs="!editScript",Ks=(0,W.Fl)(()=>{const e=I.route.paths[0];return Bs.find(t=>t.name===e)||Bs[0]}),Js=(0,W.Fl)(()=>({[o]:I.scripts.length,[_]:I.removedScripts.length}));function Gs(){const e=Ks.value.name===o,{paths:t}=I.route;Y.$J.setContext("editScript",e&&t[1]),Y.$J.setContext("tabScripts",e&&!t[1]),Y.$J.setContext("showRecycle",Ks.value.name===_)}function Xs(e){const n=Bs.indexOf(Ks.value),l=Bs[(n+e+Bs.length)%Bs.length];t.location.hash=(null==l?void 0:l.name)||""}d("dragover",e=>{var t;["",C,o].includes(I.route.hash)&&/^application\/(zip|x-zip-compressed)$/.test(null==(t=e.dataTransfer.items[0])?void 0:t.type)&&(location.hash=`#${x}`)},!0);const Qs={setup(){const[e,t]=I.route.paths,n=(0,H.iH)(e!==o||"_new"!==t&&!Number(t));return(0,W.m0)(()=>{const{title:e}=I;document.title=e?`${e} - ${Ns}`:Ns}),(0,W.YP)(()=>I.route.paths,()=>{n.value=!0,Gs()}),(0,W.bv)(()=>{const e=[Y.$J.register("a-pageup",()=>Xs(-1),{condition:qs}),Y.$J.register("a-pagedown",()=>Xs(1),{condition:qs})];return Y.$J.enable(),Gs(),()=>{e.forEach(e=>{e()}),Y.$J.disable()}}),{tabs:Bs,current:Ks,numbers:Js,canRenderAside:n}}},er=(0,Wt.Z)(Qs,[["render",(e,t,n,l,a,o)=>((0,W.wg)(),(0,W.iD)("div",O,[l.canRenderAside?((0,W.wg)(),(0,W.iD)("aside",M,[(0,W._)("div",A,[V,(0,W._)("h1",{class:"hidden-sm",textContent:(0,T.zw)(e.i18n("extName"))},null,8,F),L,((0,W.wg)(!0),(0,W.iD)(W.HY,null,(0,W.Ko)(l.tabs,e=>((0,W.wg)(),(0,W.iD)("div",{class:"aside-menu-item",key:e.name},[(0,W._)("a",{href:`#${e.name}`,class:(0,T.C_)({active:e===l.current}),"data-num-scripts":l.numbers[e.name],textContent:(0,T.zw)(e.label)},null,10,P)]))),128))])])):(0,W.kq)("",!0),((0,W.wg)(),(0,W.j4)(W.Ob,null,[((0,W.wg)(),(0,W.j4)((0,W.LL)(l.current.comp),{class:"tab"}))],1024))]))]]),tr=[(0,U.ag)("editNavCode"),(0,U.ag)("editNavSettings"),(0,U.ag)("editNavValues"),"@require","@resource"];let nr;function lr(e,t){const n=e.meta||{},l=(0,U.iQ)(n,"name"),a=f(U.Hv,[n.name,l,n.description,(0,U.iQ)(n,"description"),e.custom.name,e.custom.description],"\n"),o=e.custom.name||l,i=o.toLowerCase();let s=0,r="";t.forEach((e,t)=>{s+=e,e&&(r+=`${tr[t]}: ${(0,U.aj)(e)}\n`)}),e.$cache={search:a,name:o,lowerName:i,size:(0,U.aj)(s,!0).replace(" ",""),sizes:r.slice(0,-1).replace(/\x20/g,"\xa0").replace(/[^B]$/gm,"$&B"),sizeNum:s},e.$canUpdate=(0,U.TZ)(e)&&(e.config.shouldUpdate?1:-1),(0,D.d)(e,I,!0)}function ar(){const e=+I.route.paths[1];return or(e?[e]:null).catch(e&&(()=>or()))}async function or(e){const[t]=await u.all([(0,U.gj)("GetData",{ids:e,sizes:!0},{retry:!0}),$.Z.ready]),{scripts:n,sizes:l,...a}=t;c.assign(I,a);const o=[],i=[];n.forEach((e,t)=>{lr(e,l[t]),(e.config.removed?i:o).push(e)}),I.scripts=o,I.removedScripts=i,I.loading=!1}I.loading=!0,ar(),c.assign(z.Z,{ScriptsUpdated(){ar()},UpdateSync(e){I.sync=e},async UpdateScript({update:e,where:t}={}){var n;if(!e)return;(nr||(nr=I.importing)&&(nr=u.race([nr,(0,U.dL)(500)])))&&(await nr,nr=null);const l=I.scripts.findIndex(e=>e.props.id===t.id),a=I.removedScripts.findIndex(e=>e.props.id===t.id),i=I.scripts[l]||I.removedScripts[a]||I.canRenderScripts&&{};if(!i)return;const[s]=await(0,U.gj)("GetSizes",[t.id]);if(c.assign(i,e),i.error&&!e.error&&(i.error=null),lr(i,s),null!=(null==(n=e.config)?void 0:n.removed)&&(e.config.removed?I.needRefresh=!0:I.removedScripts=I.removedScripts.filter(e=>e.props.id!==t.id)),(i.config.removed?a:l)<0){i.message="";const e=i.config.removed?"removedScripts":o;I[e]=[...I[e],i]}},RemoveScripts(e){I.removedScripts=I.removedScripts.filter(t=>!e.includes(t.props.id))}}),(0,R.sY)(er)},6291:(e,t,n)=>{var l={"./arrow.svg":943,"./author.svg":7767,"./code.svg":4064,"./cog.svg":9640,"./command.svg":4507,"./filter.svg":5698,"./home.svg":7030,"./info.svg":6501,"./more.svg":8614,"./plus.svg":2996,"./question.svg":1902,"./refresh.svg":1694,"./search.svg":1112,"./toggle-off.svg":6817,"./toggle-on.svg":385,"./trash.svg":4289,"./undo.svg":8947};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(l,e)){var t=new r("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return l[e]}a.keys=()=>c.keys(l),a.resolve=o,e.exports=a,a.id=6291}},D={};function $(e){var t=D[e];if(void 0!==t)return t.exports;var n=D[e]={exports:{}};return z[e].call(n.exports,n,n.exports,$),n.exports}$.m=z,h=[],$.O=(e,t,n,l)=>{if(!t){var a=1/0;for(r=0;r<h.length;r++){for(var[t,n,l]=h[r],o=!0,i=0;i<t.length;i++)(!1&l||a>=l)&&c.keys($.O).every(e=>$.O[e](t[i]))?t.splice(i--,1):(o=!1,l<a&&(a=l));if(o){h.splice(r--,1);var s=n();void 0!==s&&(e=s)}}return e}l=l||0;for(var r=h.length;r>0&&h[r-1][2]>l;r--)h[r]=h[r-1];h[r]=[t,n,l]},$.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return $.d(t,{a:t}),t},U=c.getPrototypeOf?e=>c.getPrototypeOf(e):e=>e.__proto__,$.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=c.create(null);$.r(n);var l={};S=S||[null,U({}),U([]),U(U)];for(var a=2&t&&e;"object"==typeof a&&!~S.indexOf(a);a=U(a))c.getOwnPropertyNames(a).forEach(t=>l[t]=()=>e[t]);return l.default=()=>e,$.d(n,l),n},$.d=(e,t)=>{for(var n in t)$.o(t,n)&&!$.o(e,n)&&c.defineProperty(e,n,{enumerable:!0,get:t[n]})},$.o=(e,t)=>c.prototype.hasOwnProperty.call(e,t),$.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&c.defineProperty(e,Symbol.toStringTag,{value:"Module"}),c.defineProperty(e,"__esModule",{value:!0})},$.j=360,(()=>{var e={360:0};$.O.j=t=>0===e[t];var t=(t,n)=>{var l,a,[o,i,s]=n,r=0;if(o.some(t=>0!==e[t])){for(l in i)$.o(i,l)&&($.m[l]=i[l]);if(s)var c=s($)}for(t&&t(n);r<o.length;r++)a=o[r],$.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return $.O(c)},n=self.webpackChunkviolentmonkey=self.webpackChunkviolentmonkey||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var R=$.O(void 0,[386,84],()=>$(8904));R=$.O(R)})()}